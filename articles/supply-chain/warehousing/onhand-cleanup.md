---
title: Sandėlio valdymo turimų įrašų valymo užduotis
description: Šioje temoje aprašoma turimų atsargų valymo užduotis, kuri padeda pagerinti sistemos efektyvumą nustatant ir naikinant susijusius, bet nereikalingus įrašus.
author: perlynne
manager: tfehr
ms.date: 04/23/2020
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-applications
ms.technology: ''
ms.search.form: SysOperationTemplateForm
audience: Application User
ms.reviewer: kamaybac
ms.search.region: Global
ms.author: perlynne
ms.search.validFrom: 2020-04-03
ms.dyn365.ops.version: Release 10.0.12
ms.openlocfilehash: 93c77434a912554dab486b42c0c9fffd68cf9435
ms.sourcegitcommit: eaf330dbee1db96c20d5ac479f007747bea079eb
ms.translationtype: HT
ms.contentlocale: lt-LT
ms.lasthandoff: 02/15/2021
ms.locfileid: "5226008"
---
# <a name="warehouse-management-on-hand-entries-cleanup-job"></a><span data-ttu-id="b61a0-103">Sandėlio valdymo turimų įrašų valymo užduotis</span><span class="sxs-lookup"><span data-stu-id="b61a0-103">Warehouse management on-hand entries cleanup job</span></span>

<span data-ttu-id="b61a0-104">Užklausų, naudojamų skaičiuojant turimas atsargas, efektyvumas priklauso nuo įtrauktų lentelių įrašų skaičius.</span><span class="sxs-lookup"><span data-stu-id="b61a0-104">The performance of queries that are used to calculate on-hand inventory is affected by the number of records in the tables that are involved.</span></span> <span data-ttu-id="b61a0-105">Vienas iš būdų pagerinti efektyvumą yra sumažinti įrašų, kuriuos turi įvertinti duomenų bazė, skaičių.</span><span class="sxs-lookup"><span data-stu-id="b61a0-105">One way to help improve the performance is to reduce the number of records that the database must consider.</span></span>

<span data-ttu-id="b61a0-106">Šioje temoje aprašomos turimų įrašų valymo užduotys, kurios panaikina nereikalingus įrašus lentelėse „InventSum“ ir „WHSInventReserve“.</span><span class="sxs-lookup"><span data-stu-id="b61a0-106">This topic describes the on-hand entries cleanup job, which deletes unneeded records in the InventSum and WHSInventReserve tables.</span></span> <span data-ttu-id="b61a0-107">Šiose lentelėse saugoma turima informacija apie prekes, kurios yra įjungtos atliekant sandėlio valdymo apdorojimą.</span><span class="sxs-lookup"><span data-stu-id="b61a0-107">These tables store on-hand information for items that are enabled for warehouse management processing.</span></span> <span data-ttu-id="b61a0-108">(Šios prekės vadinamos WHS prekėmis.) Šio įrašo panaikinimas gali ženkliai pagerinti turimų skaičiavimų efektyvumą.</span><span class="sxs-lookup"><span data-stu-id="b61a0-108">(These items are referred to as WHS items.) Deletion of these records can significantly improve the performance of on-hand calculations.</span></span>

## <a name="what-the-cleanup-job-does"></a><span data-ttu-id="b61a0-109">Ką atlieka valymo užduotis</span><span class="sxs-lookup"><span data-stu-id="b61a0-109">What the cleanup job does</span></span>

<span data-ttu-id="b61a0-110">Turimų įrašų valymo užduotis panaikina visus įrašus, esančius lentelėse „WHSInventReserve“ ir „InventSum“, kur visų laukų reikšmės yra *0* (nulis).</span><span class="sxs-lookup"><span data-stu-id="b61a0-110">The on-hand entries cleanup job deletes any records in the WHSInventReserve and InventSum tables where all the field values are *0* (zero).</span></span> <span data-ttu-id="b61a0-111">Šiuos įrašus galima panaikinti, nes jie neprisideda prie turimos informacijos.</span><span class="sxs-lookup"><span data-stu-id="b61a0-111">These records can be deleted because they don't contribute to the on-hand information.</span></span> <span data-ttu-id="b61a0-112">Užduotis panaikina tik žemesnius nei **Vietos** lygmens įrašus.</span><span class="sxs-lookup"><span data-stu-id="b61a0-112">The job deletes only records that are below the **Location** level.</span></span>

<span data-ttu-id="b61a0-113">Jei leidžiamos neigiamos fizinės atsargos, valymo užduočiai gali nepavykti panaikinti visų atitinkamų įrašų.</span><span class="sxs-lookup"><span data-stu-id="b61a0-113">If negative physical inventory is allowed, the cleanup job might not be able to delete all the relevant entries.</span></span> <span data-ttu-id="b61a0-114">Šis apribojimas taikomas todėl, kad užduotis turi numatyti specialų scenarijų, kai numerio lentelėje yra keli serijos numeriai, o vienas iš tų serijos numerių tapo neigiamu.</span><span class="sxs-lookup"><span data-stu-id="b61a0-114">The reason for this limitation is that the job must allow for a special scenario where a license plate has multiple serial numbers, and one of those serial numbers has become negative.</span></span> <span data-ttu-id="b61a0-115">Pavyzdžiui, sistemos numerio lentelėje bus nulis, kai numerio lentelėje yra +1 vnt. 1 serijos numerio 1 ir –1 vnt. 2 serijos numerio.</span><span class="sxs-lookup"><span data-stu-id="b61a0-115">For example, the system will have zero on hand at the license plate level when a license plate has +1 pcs of serial number 1 and –1 pcs of serial number 2.</span></span> <span data-ttu-id="b61a0-116">Naudojant šį specialų scenarijų, pirmiausia bus bendrai panaikinti žemesnių lygių įrašai.</span><span class="sxs-lookup"><span data-stu-id="b61a0-116">For this special scenario, the job does a breadth-first deletion, where it tries to delete from lower levels first.</span></span>

## <a name="schedule-and-configure-the-cleanup-job"></a><span data-ttu-id="b61a0-117">Valymo užduočių planavimas ir konfigūravimas</span><span class="sxs-lookup"><span data-stu-id="b61a0-117">Schedule and configure the cleanup job</span></span>

<span data-ttu-id="b61a0-118">Turimų atsargų valymo užduotį galima atlikti dalyje **Atsargų valdymas \> Reguliarios užduotys \> Valyti \> Sandėlio valdymo turimų įrašų valymas**.</span><span class="sxs-lookup"><span data-stu-id="b61a0-118">The on-hand entries cleanup job is available at **Inventory management \> Periodic tasks \> Clean up \> Warehouse management on-hand entries cleanup**.</span></span> <span data-ttu-id="b61a0-119">Naudokite standartines užduoties nuostatas, norėdami valdyti užduoties vykdymo apimtį ir grafiką.</span><span class="sxs-lookup"><span data-stu-id="b61a0-119">Use the standard job settings to control the scope and schedule for running the job.</span></span> <span data-ttu-id="b61a0-120">Be to, suteikiami toliau nurodyti parametrai:</span><span class="sxs-lookup"><span data-stu-id="b61a0-120">In addition, the following settings are provided:</span></span>

- <span data-ttu-id="b61a0-121">**Naikinti, jei neatnaujinta nurodytą dienų skaičių** – įveskite minimalų dienų skaičių, kurį turi laukti ši užduotis, prieš panaikindama turimą įrašo, kurio kiekis sumažėjo iki nulio.</span><span class="sxs-lookup"><span data-stu-id="b61a0-121">**Delete if not updated for this many days** – Enter the minimum number of days that the job should wait before it deletes an on-hand entry that has dropped to zero quantity.</span></span> <span data-ttu-id="b61a0-122">Naudokite šį parametrą, kad nepanaikintumėte vis dar naudojamų turimų įrašų.</span><span class="sxs-lookup"><span data-stu-id="b61a0-122">Use this setting to help reduce the risk of deleting on-hand entries that are still being used.</span></span> <span data-ttu-id="b61a0-123">Jei norite, kad valymas būtų atliekamas kuo greičiau, įveskite *0* (nulis) arba palikite lauką tuščią.</span><span class="sxs-lookup"><span data-stu-id="b61a0-123">If you want cleanup to occur as soon as possible, either enter *0* (zero) or leave the field blank.</span></span>
- <span data-ttu-id="b61a0-124">**Maksimalus vykdymo laikas (valandomis)** – įveskite maksimalų valymo užduoties vykdymo laiką valandomis.</span><span class="sxs-lookup"><span data-stu-id="b61a0-124">**Maximum execution time (hours)** – Enter the maximum execution time of the cleanup job, in hours.</span></span> <span data-ttu-id="b61a0-125">Jei užduotis neužbaigiama per šį laikotarpį, atliktas darbas įrašomas ir užduotis išsijungia.</span><span class="sxs-lookup"><span data-stu-id="b61a0-125">If the job isn't completed before this time passes, it will save the work that it has completed so far and then close itself.</span></span> <span data-ttu-id="b61a0-126">Šis galimybė ypač aktuali atvejais, kai atsargos aktyviai naudojamos.</span><span class="sxs-lookup"><span data-stu-id="b61a0-126">This capability is especially relevant for implementations that have high inventory use.</span></span> <span data-ttu-id="b61a0-127">Tokiais atvejais turite suplanuoti užduotį, kurią reikia paleisti, kai sistemos apkrova yra kuo mažesnė.</span><span class="sxs-lookup"><span data-stu-id="b61a0-127">In these cases, you should schedule the job to run at times when the system load is as light as possible.</span></span> <span data-ttu-id="b61a0-128">Jei norite, kad paketinė užduotis tęstųsi, kol ji bus baigta, įveskite *0* (nulis) arba palikite lauką tuščią.</span><span class="sxs-lookup"><span data-stu-id="b61a0-128">If you want the batch job to continue to run until it's completed, either enter *0* (zero) or leave the field blank.</span></span> <span data-ttu-id="b61a0-129">Šis parametras galimas tik tada, kai [jūsų sistemoje įjungta susijusi funkcija](#max-execution-time).</span><span class="sxs-lookup"><span data-stu-id="b61a0-129">This setting is available only if the related feature has been [turned on in your system](#max-execution-time).</span></span>

<span data-ttu-id="b61a0-130">Nors užduotį galite vykdyti įprastomis darbo valandomis, rekomenduojame paleisti ją ne darbo valandomis.</span><span class="sxs-lookup"><span data-stu-id="b61a0-130">Although you can run the job during regular business hours, we recommend that you run it outside working hours.</span></span> <span data-ttu-id="b61a0-131">Tokiu būdu išvengsite konfliktų, kurių gali kilti, jei vartotojas dirba su įrašu, kuris tuo pačiu yra naikinamas.</span><span class="sxs-lookup"><span data-stu-id="b61a0-131">In this way, you help prevent conflicts that can occur if a user is working with a record that is also being cleaned up.</span></span>

<span data-ttu-id="b61a0-132">Jei užduotis mėgina panaikinti prekės įrašą, kol įrašu naudojasi kitas vartotojas, valymo užduočiai arba naudotojui pranešama apie aklavietės klaidą.</span><span class="sxs-lookup"><span data-stu-id="b61a0-132">If the job tries to delete a record for an item while that record is being used by another user, a deadlock error occurs for either the cleanup job or the user.</span></span>

<span data-ttu-id="b61a0-133">Kai užduotis vykdoma, jos vykdymo dydis yra 100.</span><span class="sxs-lookup"><span data-stu-id="b61a0-133">When the job runs, it has a commit size of 100.</span></span> <span data-ttu-id="b61a0-134">Kitaip tariant, ji bus vykdoma kas 100 panaikinimų.</span><span class="sxs-lookup"><span data-stu-id="b61a0-134">In other words, it will try to commit one time for every 100 deletions.</span></span> <span data-ttu-id="b61a0-135">Tačiau, kadangi kai kurie naikinimai yra grįsti rinkiniais, kai kuriais atvejais ta pačia operacija galima panaikinti daugiau kaip 100 įrašų.</span><span class="sxs-lookup"><span data-stu-id="b61a0-135">However, because some deletions are set-based, there might be scenarios where more than 100 records can be deleted in the same transaction.</span></span> <span data-ttu-id="b61a0-136">Todėl vis tiek gali kilti konfliktų.</span><span class="sxs-lookup"><span data-stu-id="b61a0-136">Therefore, lock escalations can still sometimes occur.</span></span>

## <a name="possible-user-impact"></a><span data-ttu-id="b61a0-137">Galimas poveikis vartotojams</span><span class="sxs-lookup"><span data-stu-id="b61a0-137">Possible user impact</span></span>

<span data-ttu-id="b61a0-138">Vartotojai gali pajusti poveikį, jei turimų įrašų valymo užduotis panaikina visus nurodyto lygio įrašus (pvz., numerio lentelės lygį).</span><span class="sxs-lookup"><span data-stu-id="b61a0-138">Users might be affected if the on-hand entries cleanup job deletes all the records for a given level (such as the license plate level).</span></span> <span data-ttu-id="b61a0-139">Tokiu atveju turimos atsargos numerio lentelėje gali būti nerodomos kaip tikimasi, nes atitinkamų turimų atsargų įrašų nebėra.</span><span class="sxs-lookup"><span data-stu-id="b61a0-139">In this case, the functionality for seeing that inventory was previously available on-hand at a license plate might not work as expected because the relevant on-hand entries are no longer available.</span></span> <span data-ttu-id="b61a0-140">Taip, pavyzdžiui, gali nutikti šiose situacijose:</span><span class="sxs-lookup"><span data-stu-id="b61a0-140">This can, for example, be experienced in the following situations:</span></span>

- <span data-ttu-id="b61a0-141">Kai vartotojas **Turimo kiekio sąraše**, atšaukia sąlygos **Kiekis \<\> „0”** pasirinkimą arba pasirenka **Uždarytos operacijos** sąlygą, esančią **Dimensijų rodymas** parametruose.</span><span class="sxs-lookup"><span data-stu-id="b61a0-141">On the **On-hand list**, when the user deselects the condition **Quantity \<\> 0** or selects the condition **Closed transactions** in the **Dimensions display** settings.</span></span>
- <span data-ttu-id="b61a0-142">Ataskaitoje **Faktinės atsargos pagal atsargų dimensiją** apie praėjusius laikotarpius, kai vartotojas nustato **Iki datos** parametrą.</span><span class="sxs-lookup"><span data-stu-id="b61a0-142">In a **Physical inventory by inventory dimension** report for past periods, when the user sets the **As of date** parameter.</span></span>

<span data-ttu-id="b61a0-143">Tačiau efektyvumo patobulinimas, kurį suteikia valymo užduotis, turėtų padengti šiuos smulkius funkcionalumo nuostolius.</span><span class="sxs-lookup"><span data-stu-id="b61a0-143">However, the performance improvement that the cleanup job provides should make up for these small losses in functionality.</span></span>

## <a name="make-the-maximum-execution-time-setting-available"></a><a name="max-execution-time"></a><span data-ttu-id="b61a0-144">Maksimalaus vykdymo laiko parametro įgalinimas</span><span class="sxs-lookup"><span data-stu-id="b61a0-144">Make the Maximum execution time setting available</span></span>

<span data-ttu-id="b61a0-145">Pagal numatytuosius nustatymus **Maksimalaus vykdymo laiko** parametras yra nepasiekiamas.</span><span class="sxs-lookup"><span data-stu-id="b61a0-145">By default, the **Maximum execution time** setting isn't available.</span></span> <span data-ttu-id="b61a0-146">Jei norite juo naudotis, turite naudoti [funkcijų valdymą](../../fin-ops-core/fin-ops/get-started/feature-management/feature-management-overview.md), kad galėtumėte įjungti susijusią priemonę savo sistemoje.</span><span class="sxs-lookup"><span data-stu-id="b61a0-146">If you want to use it, you must use [feature management](../../fin-ops-core/fin-ops/get-started/feature-management/feature-management-overview.md) to turn on the related feature in your system.</span></span> <span data-ttu-id="b61a0-147">Darbo srityje **Funkcijų valdymas** ši funkcija yra nurodyta toliau pateikiamu būdu.</span><span class="sxs-lookup"><span data-stu-id="b61a0-147">In the **Feature management** workspace, the feature is listed in the following way:</span></span>

- <span data-ttu-id="b61a0-148">**Modulis:** *sandėlio valdymas*</span><span class="sxs-lookup"><span data-stu-id="b61a0-148">**Module:** *Warehouse management*</span></span>
- <span data-ttu-id="b61a0-149">**Funkcijos pavadinimas:** *maksimalus vykdymo laikas sandėlio valdymo turimų įrašų valymo užduočiai*</span><span class="sxs-lookup"><span data-stu-id="b61a0-149">**Feature name:** *Maximum execution time for the warehouse management on-hand entries cleanup job*</span></span>


[!INCLUDE[footer-include](../../includes/footer-banner.md)]