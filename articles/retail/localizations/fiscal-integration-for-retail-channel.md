---
title: Mažmeninės prekybos kanalų fiskalinės integracijos apžvalga
description: Šioje temoje pateikiama fiskalinės integracijos galimybių, teikiamų „Microsoft Dynamics 365 for Retail“, apžvalga.
author: josaw
manager: annbe
ms.date: 02/01/2019
ms.topic: article
ms.prod: ''
ms.service: dynamics-365-retail
ms.technology: ''
ms.search.form: RetailFunctionalityProfile, RetailFormLayout, RetailParameters
audience: Application User
ms.reviewer: josaw
ms.search.scope: Core, Operations, Retail
ms.search.region: Global
ms.search.industry: Retail
ms.author: v-kikozl
ms.search.validFrom: 2019-1-16
ms.dyn365.ops.version: 10
ms.openlocfilehash: 3c6092a7eba328048ef2f28188c42f33cb1f7136
ms.sourcegitcommit: 9796d022a8abf5c07abcdee6852ee34f06d2eb57
ms.translationtype: HT
ms.contentlocale: lt-LT
ms.lasthandoff: 04/12/2019
ms.locfileid: "950409"
---
# <a name="overview-of-fiscal-integration-for-retail-channels"></a><span data-ttu-id="534cd-103">Mažmeninės prekybos kanalų fiskalinės integracijos apžvalga</span><span class="sxs-lookup"><span data-stu-id="534cd-103">Overview of fiscal integration for Retail channels</span></span>

[!include [banner](../includes/banner.md)]

## <a name="introduction"></a><span data-ttu-id="534cd-104">Įžanga</span><span class="sxs-lookup"><span data-stu-id="534cd-104">Introduction</span></span>

<span data-ttu-id="534cd-105">Ši tema yra fiskalinės integracijos galimybių, teikiamų „Microsoft Dynamics 365 for Retail“, apžvalga.</span><span class="sxs-lookup"><span data-stu-id="534cd-105">This topic is an overview of the fiscal integration capabilities that are available in Microsoft Dynamics 365 for Retail.</span></span> <span data-ttu-id="534cd-106">Fiskalinė integracija apima integravimą įvairiais finansiniais įrenginiais ir tarnybomis, kurie užtikrina mažmeninės prekybos pardavimo fiskalinę integraciją su vietos mokesčių įstatymais, kuriais siekiama užkirsti kelią mokesčių sukčiavimui mažmeninės prekybos srityje.</span><span class="sxs-lookup"><span data-stu-id="534cd-106">Fiscal integration includes integration with various fiscal devices and services that enable fiscal registration of retail sales in accordance with local fiscal laws that are aimed at preventing tax fraud in the retail industry.</span></span> <span data-ttu-id="534cd-107">Toliau pateikti keli įprasti scenarijai, kurių atveju būtų galima naudotis fiskaline integracija.</span><span class="sxs-lookup"><span data-stu-id="534cd-107">Here are some typical scenarios that can be covered by using fiscal integration:</span></span>

- <span data-ttu-id="534cd-108">Užregistruokite mažmeninės prekybos pardavimą finansiniame įrenginyje, prijungtame prie mažmeninės prekybos elektroninio kasos aparato (EKA), pvz., fiskalinio spausdintuvo, ir išspausdinkite klientui skirtą fiskalinį kvitą.</span><span class="sxs-lookup"><span data-stu-id="534cd-108">Register a retail sale on a fiscal device that is connected to Retail point of sale (POS), such as a fiscal printer, and print a fiscal receipt for the customer.</span></span>
- <span data-ttu-id="534cd-109">Saugiai pateikite informaciją, susijusią su pardavimu ir grąžinimu, kurie yra užbaigti „Retail POS“, į išorinę žiniatinklio tarnybą, kurią valdo mokesčių inspekcija.</span><span class="sxs-lookup"><span data-stu-id="534cd-109">Securely submit information that is related to sales and returns that are completed in Retail POS to an external web-service that is operated by the tax authority.</span></span>
- <span data-ttu-id="534cd-110">Padėkite užtikrinti pardavimo operacijų duomenų nekeičiamumą naudodami skaitmeninius parašus.</span><span class="sxs-lookup"><span data-stu-id="534cd-110">Help guarantee inalterability of sales transaction data through digital signatures.</span></span>

<span data-ttu-id="534cd-111">Mažmeninės prekybos fiskalinės integracijos funkcija yra sistema, kuri suteikia bendrą „Retail POS“ ir finansinių įrenginių bei tarnybų integravimo tolesnės plėtros bei tinkinimo sprendimą.</span><span class="sxs-lookup"><span data-stu-id="534cd-111">The fiscal integration functionality in Retail is a framework that provides a common solution for further development and customization of the integration between Retail POS and fiscal devices and services.</span></span> <span data-ttu-id="534cd-112">Funkcija taip pat apima fiskalinės integracijos pavyzdžius, kurie palaiko pagrindinius mažmeninės prekybos scenarijus konkrečiose šalyse ar regionuose ir kurie tinka konkretiems finansiniams įrenginiams arba tarnyboms.</span><span class="sxs-lookup"><span data-stu-id="534cd-112">The functionality also includes fiscal integration samples that support basic retail scenarios for specific countries or regions, and that work with specific fiscal devices or services.</span></span> <span data-ttu-id="534cd-113">Fiskalinės integracijos pavyzdį sudaro keli mažmeninės prekybos komponentų plėtiniai ir jis įtrauktas į mažmeninės prekybos programinės įrangos kūrimo rinkinį (SDK).</span><span class="sxs-lookup"><span data-stu-id="534cd-113">A fiscal integration sample consists of several extensions of Retail components and is included in the Retail software development kit (SDK).</span></span> <span data-ttu-id="534cd-114">Daugiau informacijos apie fiskalinės integracijos pavyzdžius, kurie teikiami mažmeninės prekybos SDK, žr. [Fiskalinės integracijos pavyzdžiai mažmeninės prekybos SDK](#fiscal-integration-samples-in-the-retail-sdk).</span><span class="sxs-lookup"><span data-stu-id="534cd-114">For more information about the fiscal integration samples that are available in the Retail SDK, see [Fiscal integration samples in the Retail SDK](#fiscal-integration-samples-in-the-retail-sdk).</span></span> <span data-ttu-id="534cd-115">Informacijos apie tai, kaip įdiegti ir naudoti mažmeninės prekybos SDK, žr. [Mažmeninės prekybos SDK peržiūra](../dev-itpro/retail-sdk/retail-sdk-overview.md).</span><span class="sxs-lookup"><span data-stu-id="534cd-115">For information about how to install and use the Retail SDK, see [Retail SDK overview](../dev-itpro/retail-sdk/retail-sdk-overview.md).</span></span>

<span data-ttu-id="534cd-116">Tam, kad būtų palaikomi kiti scenarijai, kurių nepalaiko fiskalinės integracijos pavyzdys, būtų integruojama „Retail POS“ su kitais finansiniais įrenginiais ar tarnybomis arba būtų išpildomi kitų šalių ar regionų reikalavimai, turite išplėsti esamą fiskalinės integracijos pavyzdį arba sukurti naują pavyzdį naudodami dėl esamą pavyzdį kaip pavyzdį.</span><span class="sxs-lookup"><span data-stu-id="534cd-116">To support other scenarios that aren't supported by a fiscal integration sample, to integrate Retail POS with other fiscal devices or services, or to cover requirements of other countries or regions, you must either extend an existing fiscal integration sample or create a new sample by using an existing sample as an example.</span></span>

## <a name="fiscal-registration-process-and-fiscal-integration-samples-for-fiscal-devices"></a><span data-ttu-id="534cd-117">Finansinių įrenginių fiskalinės integracijos procesas ir fiskalinės integracijos pavyzdžiai</span><span class="sxs-lookup"><span data-stu-id="534cd-117">Fiscal registration process and fiscal integration samples for fiscal devices</span></span>

<span data-ttu-id="534cd-118">„Retail POS“ fiskalinės integracijos procesą gali sudaryti vienas ar daugiau veiksmų.</span><span class="sxs-lookup"><span data-stu-id="534cd-118">A fiscal registration process in Retail POS can consist of one or more steps.</span></span> <span data-ttu-id="534cd-119">Kiekvieną veiksmas apima konkrečių mažmeninės prekybos operacijų arba įvykių fiskalinę integraciją viename finansiniame įrenginyje arba tarnyboje.</span><span class="sxs-lookup"><span data-stu-id="534cd-119">Each step involves fiscal registration of specific retail transactions or events in one fiscal device or service.</span></span> <span data-ttu-id="534cd-120">Toliau nurodyti sprendimo komponentai įtraukti į fiskalinę integraciją finansiniame įrenginyje, kuris prijungtas prie aparatūros stoties.</span><span class="sxs-lookup"><span data-stu-id="534cd-120">The following solution components participate in the fiscal registration in a fiscal device that is connected to a Hardware station:</span></span>

- <span data-ttu-id="534cd-121">**„Commerce Runtime“ (CRT) plėtinys** – šis komponentas sudėlioja mažmeninės prekybos operacijos / įvykio duomenis tokiu formatu, kuris taip pat naudojamas sąveikaujant su finansiniu įrenginiu, analizuoja atsakymus iš finansinio įrenginio ir saugo atsakymus kanalo duomenų bazėje.</span><span class="sxs-lookup"><span data-stu-id="534cd-121">**Commerce runtime (CRT) extension** – This component serializes retail transaction/event data in the format that is also used for interaction with the fiscal device, parses responses from the fiscal device, and stores the responses in the channel database.</span></span> <span data-ttu-id="534cd-122">Plėtinys taip pat apibrėžia konkrečias operacijas ir įvykius, kurie turi būti registruojami.</span><span class="sxs-lookup"><span data-stu-id="534cd-122">The extension also defines the specific transactions and events that must be registered.</span></span> <span data-ttu-id="534cd-123">Šis komponentas yra dažnai vadinamas *finansinio dokumento teikėju*.</span><span class="sxs-lookup"><span data-stu-id="534cd-123">This component is often referred to as a *fiscal document provider*.</span></span>
- <span data-ttu-id="534cd-124">**Aparatūros stoties plėtinys** – šis komponentas inicijuoja ryšį su finansiniu įrenginiu, siunčia užklausas ir teikia komandas finansiniam įrenginiui pagal mažmeninės prekybos operacijos / įvykio duomenis, kurie gaunami iš finansinio dokumento, ir gauna atsakymus iš finansinio įrenginio.</span><span class="sxs-lookup"><span data-stu-id="534cd-124">**Hardware station extension** – This component initializes the communication with the fiscal device, sends requests and direct commands to the fiscal device based on the retail transaction/event data that is extracted from the fiscal document, and receives responses from the fiscal device.</span></span> <span data-ttu-id="534cd-125">Šis komponentas yra dažnai vadinamas *fiskaline jungtimi*.</span><span class="sxs-lookup"><span data-stu-id="534cd-125">This component is often referred to as a *fiscal connector*.</span></span>

<span data-ttu-id="534cd-126">Finansinio įrenginio fiskalinės integracijos pavyzdyje pateikiami CRT ir aparatūros stoties plėtiniai, atitinkamai skirti finansinio dokumento teikėjo ir fiskalinei jungčiai.</span><span class="sxs-lookup"><span data-stu-id="534cd-126">A fiscal integration sample for a fiscal device contains the CRT and Hardware station extensions for a fiscal document provider and a fiscal connector, respectively.</span></span> <span data-ttu-id="534cd-127">Jame taip pat yra tolesnių komponentų konfigūracijos.</span><span class="sxs-lookup"><span data-stu-id="534cd-127">It also contains the following component configurations:</span></span>

- <span data-ttu-id="534cd-128">**Finansinio dokumento teikėjo konfigūracija** – ši konfigūracija nurodo finansinių dokumentų išvesties metodą ir formatą.</span><span class="sxs-lookup"><span data-stu-id="534cd-128">**Fiscal document provider configuration** – This configuration defines an output method and a format for fiscal documents.</span></span> <span data-ttu-id="534cd-129">Jame taip pat pateikiamas mokesčių ir mokėjimo metodų duomenų susiejimas, kad „Retail POS“ duomenys būtų suderinami su iš anksto nustatytomis finansinio įrenginio programinės aparatinės įrangos reikšmėmis.</span><span class="sxs-lookup"><span data-stu-id="534cd-129">It also contains a data mapping for taxes and payment methods, to make data from Retail POS compatible with the values that are predefined in the fiscal device firmware.</span></span>
- <span data-ttu-id="534cd-130">**Fiskalinės jungties konfigūracija** – ši konfigūracija apibrėžia faktinį ryšį su konkrečiu finansiniu įrenginiu.</span><span class="sxs-lookup"><span data-stu-id="534cd-130">**Fiscal connector configuration** – This configuration defines the physical communication with the specific fiscal device.</span></span>

<span data-ttu-id="534cd-131">Konkretaus EKA registro fiskalinės registracijos procesą apibrėžia atitinkamas parametras EKA funkcijų šablone.</span><span class="sxs-lookup"><span data-stu-id="534cd-131">A fiscal registration process for a specific POS register is defined by a corresponding setting in the POS functionality profile.</span></span> <span data-ttu-id="534cd-132">Daugiau informacijos apie tai, kaip konfigūruoti fiskalinės registracijos procesą, įkelti finansinio dokumento teikėjo ir fiskalinės jungties konfigūracijas bei keisti jų parametrus, žr. [Fiskalinės registracijos proceso nustatymas](setting-up-fiscal-integration-for-retail-channel.md#set-up-a-fiscal-registration-process).</span><span class="sxs-lookup"><span data-stu-id="534cd-132">For more details about how to configure a fiscal registration process, upload fiscal document provider and fiscal connector configurations, and change their parameters, see [Set up a fiscal registration process](setting-up-fiscal-integration-for-retail-channel.md#set-up-a-fiscal-registration-process).</span></span>

<span data-ttu-id="534cd-133">Toliau pateiktame pavyzdyje parodytas įprasta finansinio įrenginio fiskalinės registracijos vykdymo eiga.</span><span class="sxs-lookup"><span data-stu-id="534cd-133">The following example shows a typical fiscal registration execution flow for a fiscal device.</span></span> <span data-ttu-id="534cd-134">Eiga prasideda nuo įvykio EKA (pvz., pardavimo operacijos užbaigimo) ir nustato toliau nurodytą veiksmų seką.</span><span class="sxs-lookup"><span data-stu-id="534cd-134">The flow starts with an event in the POS (for example, finalization of a sales transaction) and implements the following sequence of steps:</span></span>

1. <span data-ttu-id="534cd-135">EKA reikalauja finansinio dokumento iš CRT.</span><span class="sxs-lookup"><span data-stu-id="534cd-135">The POS requests a fiscal document from CRT.</span></span>
2. <span data-ttu-id="534cd-136">CRT nustato, ar dabartinis įvykiam įvykiui būtina fiskalinė registracija.</span><span class="sxs-lookup"><span data-stu-id="534cd-136">CRT determines whether the current event requires fiscal registration.</span></span>
3. <span data-ttu-id="534cd-137">Remiantis fiskalinės registracijos proceso parametrais, CRT identifikuoja fiskalinę jungtį ir atitinkamą finansinio dokumento teikėją, kurie bus naudojami atliekant fiskalinę registraciją.</span><span class="sxs-lookup"><span data-stu-id="534cd-137">Based on the fiscal registration process settings, CRT identifies a fiscal connector and corresponding fiscal document provider to use for the fiscal registration.</span></span>
4. <span data-ttu-id="534cd-138">CRT paleidžia finansinio dokumento teikėją, kuris sugeneruoja finansinį dokumentą (pvz., XML dokumentą), nurodantį mažmeninės prekybos operaciją arba įvykį.</span><span class="sxs-lookup"><span data-stu-id="534cd-138">CRT runs the fiscal document provider that generates a fiscal document (for example, an XML document) that represents the retail transaction or event.</span></span>
5. <span data-ttu-id="534cd-139">EKA aparatūros stočiai siunčia CRT paruoštą finansinį dokumentą.</span><span class="sxs-lookup"><span data-stu-id="534cd-139">The POS sends the fiscal document that CRT prepares to a Hardware station.</span></span>
6. <span data-ttu-id="534cd-140">Aparatūros stotis paleidžia fiskalinę jungtį, kuri apdoroja finansinį dokumentą ir pateikia jo informaciją finansiniam įrenginiui arba tarnybai.</span><span class="sxs-lookup"><span data-stu-id="534cd-140">The Hardware station runs the fiscal connector that processes the fiscal document and communicates it to the fiscal device or service.</span></span>
7. <span data-ttu-id="534cd-141">EKA analizuoja atsakymą iš finansinio įrenginio arba tarnybos ir nustato, ar fiskalinė registracija atlikta sėkmingai.</span><span class="sxs-lookup"><span data-stu-id="534cd-141">The POS analyzes the response from the fiscal device or service to determine whether the fiscal registration was successful.</span></span>
8. <span data-ttu-id="534cd-142">CRT įrašo atsakymą kanalo duomenų bazėje.</span><span class="sxs-lookup"><span data-stu-id="534cd-142">CRT saves the response to the channel database.</span></span>

<span data-ttu-id="534cd-143">![Sprendimo schema](media/emea-fiscal-integration-solution.png "Sprendimo schema")</span><span class="sxs-lookup"><span data-stu-id="534cd-143">![Solution schema](media/emea-fiscal-integration-solution.png "Solution schema")</span></span>

## <a name="error-handling"></a><span data-ttu-id="534cd-144">Klaidos taisymas</span><span class="sxs-lookup"><span data-stu-id="534cd-144">Error handling</span></span>

<span data-ttu-id="534cd-145">Fiskalinės integracijos sistema teikia toliau nurodytas parinktis, skirtas spręsti problemas, kylančias fiskalinės registracijos metu.</span><span class="sxs-lookup"><span data-stu-id="534cd-145">The fiscal integration framework provides the following options to handle failures during fiscal registration:</span></span>

- <span data-ttu-id="534cd-146">**Kartoti** – operatoriai gali naudoti šią parinktį, kai problemą galima išspręsti greitai ir fiskalinę registraciją galima vykdyti iš naujo.</span><span class="sxs-lookup"><span data-stu-id="534cd-146">**Retry** – Operators can use this option when the failure can be resolved quickly, and the fiscal registration can be rerun.</span></span> <span data-ttu-id="534cd-147">Pvz., šią parinktį galima naudoti, kai finansinis įrenginys yra neprijungtas, fiskaliniame spausdintuve nėra popieriaus arba yra fiskaliniame spausdintuve kilo popieriaus strigtis.</span><span class="sxs-lookup"><span data-stu-id="534cd-147">For example, this option can be used when the fiscal device isn't connected, the fiscal printer is out of paper, or there is a paper jam in the fiscal printer.</span></span>
- <span data-ttu-id="534cd-148">**Atšaukti** – ši parinktis operatoriams suteikia galimybę atidėti dabartinės operacijos arba įvykio fiskalinę registraciją, jei ji nepavyksta.</span><span class="sxs-lookup"><span data-stu-id="534cd-148">**Cancel** – This option lets operators postpone the fiscal registration of the current transaction or event if it fails.</span></span> <span data-ttu-id="534cd-149">Po registracija atidedama, operatorius gali tęsti darbą EKA ir baigti bet kokią operaciją, kuriai fiskalinė registracija nėra būtina.</span><span class="sxs-lookup"><span data-stu-id="534cd-149">After the registration is postponed, the operator can continue to work on the POS and can complete any operation that the fiscal registration isn't required for.</span></span> <span data-ttu-id="534cd-150">Kai EKA įvyksta bet koks įvykis, kuriam būtina fiskalinė registracija (pvz., atidaroma nauja operacija), automatiškai parodomas klaidų tvarkymo dialogo langas, kuris praneša operatoriui, kad ankstesnė operacija nebuvo tinkamai užregistruota, ir pateikia klaidų tvarkymo parinktis.</span><span class="sxs-lookup"><span data-stu-id="534cd-150">When any event that requires the fiscal registration occurs in the POS (for example, a new transaction is opened), the error handling dialog box automatically appears to notify the operator that the previous transaction wasn't correctly registered and to provide the error handling options.</span></span>
- <span data-ttu-id="534cd-151">**Praleisti** – operatoriai gali naudoti šią parinktį, kai tam tikromis aplinkybėmis galima praleisti fiskalinę registraciją ir reguliarias operacijas galima tęsti EKA.</span><span class="sxs-lookup"><span data-stu-id="534cd-151">**Skip** – Operators can use this option when the fiscal registration can be omitted under specific conditions and regular operations can be continued on the POS.</span></span> <span data-ttu-id="534cd-152">Pvz., šią parinktį galima naudoti, kai pardavimo operaciją, kurios fiskalinė registracija nepavyko, galima registruoti specialiame popieriniame žurnale.</span><span class="sxs-lookup"><span data-stu-id="534cd-152">For example, this option can be used when a sales transaction that the fiscal registration failed for can be registered in a special paper journal.</span></span>
- <span data-ttu-id="534cd-153">**Pažymėti kaip užregistruotą** – operatoriai gali naudoti šią parinktį, kai operacija iš tikrųjų buvo užregistruota finansiniame įrenginyje (pavyzdžiui, išspausdintas finansinis kvitas), bet kilo problema, kai finansinis atsakymas buvo įrašomas kanalo duomenų bazėje.</span><span class="sxs-lookup"><span data-stu-id="534cd-153">**Mark as registered** – Operators can use this option when the transaction was actually registered in the fiscal device (for example, a fiscal receipt was printed), but a failure occurred when the fiscal response was being saved to the channel database.</span></span>

> [!NOTE]
> <span data-ttu-id="534cd-154">Parinktys **Praleisti** ir **Pažymėti kaip užregistruotą** turi būti suaktyvintos fiskalinės registracijos proceso metu, kad jas būtų galima naudoti.</span><span class="sxs-lookup"><span data-stu-id="534cd-154">The **Skip** and **Mark as registered** options must be activated in the fiscal registration process before they are used.</span></span> <span data-ttu-id="534cd-155">Be to, operatoriams turi būti suteiktos atitinkamos teisės.</span><span class="sxs-lookup"><span data-stu-id="534cd-155">In addition, corresponding permissions must be granted to operators.</span></span>

<span data-ttu-id="534cd-156">Parinktys **Praleisti** ir **Pažymėti kaip užregistruotą** suteikia galimybę informacijos kodams užfiksuoti šiek tiek konkrečios informacijos apie triktį, pvz., gedimo priežastį, fiskalinės registracijos praleidimo priežastį arba operacijos pažymėjimo užregistruota priežastį.</span><span class="sxs-lookup"><span data-stu-id="534cd-156">The **Skip** and **Mark as registered** options enable info codes to capture some specific information about the failure, such as the reason for the failure or a justification for skipping the fiscal registration or marking the transaction as registered.</span></span> <span data-ttu-id="534cd-157">Daugiau informacijos apie tai, kaip nustatyti klaidų tvarlymo parametrus, žr. [Klaidų tvarkymo parametrai](setting-up-fiscal-integration-for-retail-channel.md#set-error-handling-settings).</span><span class="sxs-lookup"><span data-stu-id="534cd-157">For more details about how to set up error handling parameters, see [Set error handling settings](setting-up-fiscal-integration-for-retail-channel.md#set-error-handling-settings).</span></span>

### <a name="optional-fiscal-registration"></a><span data-ttu-id="534cd-158">Nebūtina fiskalinė registracija</span><span class="sxs-lookup"><span data-stu-id="534cd-158">Optional fiscal registration</span></span>

<span data-ttu-id="534cd-159">Fiskalinė registracija gali būti privaloma tik atliekant tam tikras operacijas.</span><span class="sxs-lookup"><span data-stu-id="534cd-159">Fiscal registration might be mandatory for some operations but optional for others.</span></span> <span data-ttu-id="534cd-160">Pavyzdžiui, įprastų pardavimų ir grąžinimų atveju fiskalinė registracija gali būti privaloma, bet su kliento mokama suma susijusių operacijų fiskalinė registracija nebūtina.</span><span class="sxs-lookup"><span data-stu-id="534cd-160">For example, the fiscal registration of regular sales and returns might be mandatory, but the fiscal registration of operations that are related to customer deposits might be optional.</span></span> <span data-ttu-id="534cd-161">Neatlikus pardavimo fiskalinės registracijos, kiti pardavimai blokuojami, o neatlikus kliento mokamos sumos fiskalinės registracijos kiti pardavimai neblokuojami.</span><span class="sxs-lookup"><span data-stu-id="534cd-161">In this case, failure to complete the fiscal registration of a sale should block further sales, but failure to complete the fiscal registration of a customer deposit should not block further sales.</span></span> <span data-ttu-id="534cd-162">Tam, kad galėtumėte atskirti privalomas ir neprivalomas operacijas, rekomenduojame jas atliekant naudotis skirtingų dokumentų teikėjų paslaugomis ir nustatyti atskirus tų teikėjų fiskalinės registracijos proceso etapus.</span><span class="sxs-lookup"><span data-stu-id="534cd-162">To distinguish mandatory and optional operations, we recommend that you handle them through different document providers, and that you set up separate steps in the fiscal registration process for those providers.</span></span> <span data-ttu-id="534cd-163">Parametras **Tęsti įvykus klaidai** turi būti įgalintas atliekant bet kokį su nebūtina fiskaline registracija susijusį veiksmą.</span><span class="sxs-lookup"><span data-stu-id="534cd-163">The **Continue on error** parameter should be enabled for any step that is related to optional fiscal registration.</span></span> <span data-ttu-id="534cd-164">Daugiau informacijos apie tai, kaip nustatyti klaidų tvarlymo parametrus, žr. [Klaidų tvarkymo parametrai](setting-up-fiscal-integration-for-retail-channel.md#set-error-handling-settings).</span><span class="sxs-lookup"><span data-stu-id="534cd-164">For more details about how to set up error handling parameters, see [Set error handling settings](setting-up-fiscal-integration-for-retail-channel.md#set-error-handling-settings).</span></span>

### <a name="manually-running-fiscal-registration"></a><span data-ttu-id="534cd-165">Neautomatinė fiskalinė registracija</span><span class="sxs-lookup"><span data-stu-id="534cd-165">Manually running fiscal registration</span></span>

<span data-ttu-id="534cd-166">Jei įvykus klaidai (pvz., klaidų tvarkymo dialogo lange operatoriui paspaudus **Atšaukti**) operacijos arba įvykio fiskalinė registracija atidėta, suaktyvinę atitinkamą operaciją galite patys iš naujo paleisti fiskalinę registraciją.</span><span class="sxs-lookup"><span data-stu-id="534cd-166">If the fiscal registration of a transaction or event has been postponed after a failure (for example, if the operator selected **Cancel** in the error handling dialog box), you can manually rerun the fiscal registration by invoking a corresponding operation.</span></span> <span data-ttu-id="534cd-167">Daugiau informacijos rasite [Rankinio atidėtos fiskalinės registracijos vykdymo įgalinimas](setting-up-fiscal-integration-for-retail-channel.md#enable-manual-execution-of-postponed-fiscal-registration).</span><span class="sxs-lookup"><span data-stu-id="534cd-167">For more details, see [Enable manual execution of postponed fiscal registration](setting-up-fiscal-integration-for-retail-channel.md#enable-manual-execution-of-postponed-fiscal-registration).</span></span>

### <a name="fiscal-registration-health-check"></a><span data-ttu-id="534cd-168">Fiskalinės registracijos būsenos patikra</span><span class="sxs-lookup"><span data-stu-id="534cd-168">Fiscal registration health check</span></span>

<span data-ttu-id="534cd-169">Atliekant fiskalinės registracijos būsenos patikros procedūrą patikrinamas finansinio įrenginio ar paslaugos prieinamumas įvykus tam tikriems įvykiams.</span><span class="sxs-lookup"><span data-stu-id="534cd-169">The health check procedure for fiscal registrations verifies the availability of the fiscal device or service when specific events occur.</span></span> <span data-ttu-id="534cd-170">Jei šiuo metu fiskalinės registracijos atlikti neįmanoma, apie tai iš anksto pranešama operatoriui.</span><span class="sxs-lookup"><span data-stu-id="534cd-170">If the fiscal registration can't currently be completed, the operator is notified in advance.</span></span>

<span data-ttu-id="534cd-171">EKA būsenos patikrą atlieka įvykus toliau išvardytiems įvykiams.</span><span class="sxs-lookup"><span data-stu-id="534cd-171">The POS runs the health check when the following events occur:</span></span>

- <span data-ttu-id="534cd-172">Atidaroma nauja operacija.</span><span class="sxs-lookup"><span data-stu-id="534cd-172">A new transaction is opened.</span></span>
- <span data-ttu-id="534cd-173">Atšaukiama sulaikyta operacija.</span><span class="sxs-lookup"><span data-stu-id="534cd-173">A suspended transaction is recalled.</span></span>
- <span data-ttu-id="534cd-174">Užbaigiama pardavimo arba grąžinimo operacija.</span><span class="sxs-lookup"><span data-stu-id="534cd-174">A sales or return transaction is finalized.</span></span>

<span data-ttu-id="534cd-175">Jei būsenos patikros rezultatai neigiami, EKA rodomas būsenos patikros dialogo langas.</span><span class="sxs-lookup"><span data-stu-id="534cd-175">If the health check fails, the POS shows the health check dialog box.</span></span> <span data-ttu-id="534cd-176">Šiame dialogo lange rodomi toliau išvardyti mygtukai.</span><span class="sxs-lookup"><span data-stu-id="534cd-176">This dialog box provides the following buttons:</span></span>

- <span data-ttu-id="534cd-177">**Gerai** – paspaudęs šį mygtuką operatorius gali nepaisyti būsenos patikros klaidos ir toliau vykdyti operaciją.</span><span class="sxs-lookup"><span data-stu-id="534cd-177">**OK** – This button lets the operator ignore a health check error and continue to process the operation.</span></span> <span data-ttu-id="534cd-178">Operatoriai gali paspausti šį mygtuką tik tuo atveju, jei jiems įgalinta teisė **Leisti nepaisyti būsenos patikros klaidos**.</span><span class="sxs-lookup"><span data-stu-id="534cd-178">Operators can select this button only if the **Allow skip health check error** permission is enabled for them.</span></span>
- <span data-ttu-id="534cd-179">**Atšaukti** – operatoriui paspaudus šį mygtuką, EKA atšaukia paskutinį veiksmą (pvz., prekė neįtraukiama į naują operaciją).</span><span class="sxs-lookup"><span data-stu-id="534cd-179">**Cancel** – If the operator selects this button, the POS cancels the last action (for example, an item isn't added to a new transaction).</span></span>

> [!NOTE]
> <span data-ttu-id="534cd-180">Būsenos patikra atliekama tik tuo atveju, jei atliekant dabartinę operaciją reikia atlikti fiskalinę registraciją ir jei atliekant dabartinį fiskalinės registracijos proceso veiksmą išjungtas parametras **Tęsti įvykus klaidai**.</span><span class="sxs-lookup"><span data-stu-id="534cd-180">The health check is run only if the current operation requires fiscal registration, and if  the **Continue on error** parameter is disabled for the current step of the fiscal registration process.</span></span> <span data-ttu-id="534cd-181">Daugiau informacijos rasite [Klaidų tvarkymo parametrų nustatymas](setting-up-fiscal-integration-for-retail-channel.md#set-error-handling-settings).</span><span class="sxs-lookup"><span data-stu-id="534cd-181">For more details, see [Set error handling settings](setting-up-fiscal-integration-for-retail-channel.md#set-error-handling-settings).</span></span>

## <a name="storing-fiscal-response-in-fiscal-transaction"></a><span data-ttu-id="534cd-182">Finansinio atsakymo saugojimas finansinėje operacijoje</span><span class="sxs-lookup"><span data-stu-id="534cd-182">Storing fiscal response in fiscal transaction</span></span>

<span data-ttu-id="534cd-183">Kai operacijos arba įvykio fiskalinė registracija sėkminga, finansinė operacija sukuriama kanalo duomenų bazėje ir susiejama su pradine operacija arba įvykiu.</span><span class="sxs-lookup"><span data-stu-id="534cd-183">When fiscal registration of a transaction or event is successful, a fiscal transaction is created in the channel database and linked to the original transaction or event.</span></span> <span data-ttu-id="534cd-184">Be to, pasirenkama nepavykusios finansinės registracijos parinktis **Praleisti** arba **Pažymėti kaip užregistruotą**, ši informacija yra saugoma finansinėje operacijoje.</span><span class="sxs-lookup"><span data-stu-id="534cd-184">Similarly, if the **Skip** or **Mark as registered** option is selected for a failed fiscal registration, this information is stored in a fiscal transaction.</span></span> <span data-ttu-id="534cd-185">Finansinėje operacijoje saugomas finansinis atsakymas iš finansinio įrenginio ar tarnybos.</span><span class="sxs-lookup"><span data-stu-id="534cd-185">A fiscal transaction holds the fiscal response of the fiscal device or service.</span></span> <span data-ttu-id="534cd-186">Jei fiskalinės registracijos procesą sudaro keli etapai, finansinė operacija sukuriamas atliekant kiekvieną proceso veiksmą, po kurio registracija pavyko arba nepavyko.</span><span class="sxs-lookup"><span data-stu-id="534cd-186">If the fiscal registration process consists of several steps, a fiscal transaction is created for each step of the process that resulted in a successful or failed registration.</span></span>

<span data-ttu-id="534cd-187">*P užduotis* perkelia finansines operacijas į „Retail Headquarters“ kartu su mažmeninės prekybos operacijomis.</span><span class="sxs-lookup"><span data-stu-id="534cd-187">Fiscal transactions are transferred to Retail Headquarters by the *P-job*, together with retail transactions.</span></span> <span data-ttu-id="534cd-188">Puslapio **Mažmeninės prekybos parduotuvės operacijos** „FastTab“ **Finansinės operacijos** galite peržiūrėti finansines operacijas, susietas su mažmeninės prekybos operacijomis.</span><span class="sxs-lookup"><span data-stu-id="534cd-188">On the **Fiscal transactions** FastTab of the **Retail store transactions** page, you can view the fiscal transactions that are linked to retail transactions.</span></span>

<span data-ttu-id="534cd-189">Finansinėje operacijoje saugoma toliau nurodyta informacija.</span><span class="sxs-lookup"><span data-stu-id="534cd-189">A fiscal transaction stores the following details:</span></span>

- <span data-ttu-id="534cd-190">Fiskalinės registracijos proceso informacija (procesas, jungčių grupė, jungtis ir t. t.).</span><span class="sxs-lookup"><span data-stu-id="534cd-190">Fiscal registration process details (process, connector group, connector, and so on).</span></span> <span data-ttu-id="534cd-191">Jos lauke **Registro numeris** taip pat saugomas finansinio įrenginio serijos numeris, jei ši informacija įtraukta į finansinį atsakymą.</span><span class="sxs-lookup"><span data-stu-id="534cd-191">It also stores the serial number of the fiscal device in the **Register number** field, if this information is included in the fiscal response.</span></span>
- <span data-ttu-id="534cd-192">Fiskalinės registracijos būsena: **Baigta**, jei registracija baigta sėkmingai, **Praleista**, jei operatorius pasirinko parinktį **Praleisti**, kai registracija nepavyko, arba **Pažymėta kaip užregistruota**, jei operatorius pasirinko parinktį **Pažymėti kaip užregistruotą**.</span><span class="sxs-lookup"><span data-stu-id="534cd-192">The status of the fiscal registration: **Completed** for successful registration, **Skipped** if the operator selected the **Skip** option for a failed registration, or **Marked as registered** if the operator selected the **Mark as registered** option.</span></span>
- <span data-ttu-id="534cd-193">Informacijos kodo operacijos, susijusios su pasirinkta finansine operacija.</span><span class="sxs-lookup"><span data-stu-id="534cd-193">Info code transactions that are related to a selected fiscal transaction.</span></span> <span data-ttu-id="534cd-194">Norėdami peržiūrėti informacijos kodų operacijas, „FastTab“ **Finansinės operacijos** pasirinkite finansinę operaciją, kurios būsena yra **Praleista** arba **Pažymėta kaip užregistruota**, tada pasirinkite **Informacijos kodų operacijos**.</span><span class="sxs-lookup"><span data-stu-id="534cd-194">To view the info code transactions, on the **Fiscal transactions** FastTab, select a fiscal transaction that has a status of **Skipped** or **Marked as registered**, and then select **Info code transactions**.</span></span>

## <a name="fiscal-texts-for-discounts"></a><span data-ttu-id="534cd-195">Nuolaidų finansinis tekstas</span><span class="sxs-lookup"><span data-stu-id="534cd-195">Fiscal texts for discounts</span></span>

<span data-ttu-id="534cd-196">Kai kuriose šalyse ar regionuose taikomi specialūs reikalavimai dėl papildomo teksto, kuris turi būti išspausdintas ant finansinių kvitų, kai taikomas skirtingų tipų nuolaidos.</span><span class="sxs-lookup"><span data-stu-id="534cd-196">Some countries or regions have special requirements about additional texts that must be printed on fiscal receipts when different kinds of discounts are applied.</span></span> <span data-ttu-id="534cd-197">Fiskalinės integracijos funkcija suteikia galimybę nustatyti specialų nuolaidos tekstą, kuris išspausdinamas po nuolaidos eilute finansiniame kvite.</span><span class="sxs-lookup"><span data-stu-id="534cd-197">The fiscal integration functionality lets you set up a special text for a discount that is printed after a discount line on a fiscal receipt.</span></span> <span data-ttu-id="534cd-198">Jei nuolaidos neautomatinės, galite sukonfigūruoti finansinį tekstą, taikomą informacijos kodui, nurodytam EKA funkcijų šablono informacijos kode **Produkto nuolaida**.</span><span class="sxs-lookup"><span data-stu-id="534cd-198">For manual discounts, you can configure a fiscal text for the info code that is specified as the **Product discount** info code in the POS functionality profile.</span></span> <span data-ttu-id="534cd-199">Daugiau informacijos apie tai, kaip nustatyti nuolaidų finansinį tekstą, žr. [Nuolaidų finansinio teksto nustatymas](setting-up-fiscal-integration-for-retail-channel.md#set-up-fiscal-texts-for-discounts).</span><span class="sxs-lookup"><span data-stu-id="534cd-199">For more details about how to set up fiscal texts for discounts, see [Set up fiscal texts for discounts](setting-up-fiscal-integration-for-retail-channel.md#set-up-fiscal-texts-for-discounts).</span></span>

## <a name="printing-fiscal-x-and-fiscal-z-reports"></a><span data-ttu-id="534cd-200">Finansinių X ir Z ataskaitų spausdinimas</span><span class="sxs-lookup"><span data-stu-id="534cd-200">Printing fiscal X and fiscal Z reports</span></span>

<span data-ttu-id="534cd-201">Fiskalinės integracijos funkcija palaiko konkretaus integruoto finansinio įrenginio arba tarnybos dienos pabaigos išrašų generavimą.</span><span class="sxs-lookup"><span data-stu-id="534cd-201">Fiscal integration functionality supports generation of end-of-day statements that are specific to the integrated fiscal device or service:</span></span>

- <span data-ttu-id="534cd-202">Nauji mygtukai, kurie vykdo atitinkamas operacijas, turėtų būti įtraukti į EKA ekrano maketą.</span><span class="sxs-lookup"><span data-stu-id="534cd-202">New buttons that run corresponding operations should be added to the POS screen layout.</span></span> <span data-ttu-id="534cd-203">Daugiau informacijos žr. [Finansinio X / Z ataskaitų nustatymas iš EKA](setting-up-fiscal-integration-for-retail-channel.md#set-up-fiscal-xz-reports-from-the-pos).</span><span class="sxs-lookup"><span data-stu-id="534cd-203">For more details, see [Set up fiscal X/Z reports from the POS](setting-up-fiscal-integration-for-retail-channel.md#set-up-fiscal-xz-reports-from-the-pos).</span></span>
- <span data-ttu-id="534cd-204">Fiskalinės integracijos pavyzdyje šios operacijos turėtų būti sugretintos su atitinkamomis finansinio įrenginio operacijomis.</span><span class="sxs-lookup"><span data-stu-id="534cd-204">In the fiscal integration sample, these operations should be matched to the corresponding operations of the fiscal device.</span></span>

## <a name="fiscal-integration-samples-in-the-retail-sdk"></a><span data-ttu-id="534cd-205">Mažmeninės prekybos SDK fiskalinės integracijos pavyzdžiai</span><span class="sxs-lookup"><span data-stu-id="534cd-205">Fiscal integration samples in the Retail SDK</span></span>

<span data-ttu-id="534cd-206">Toliau pateikti fiskalinės integracijos pavyzdžiai šiuo metu teikiami „Retail SDK“, kuris leidžiamas kartu su „Retail“.</span><span class="sxs-lookup"><span data-stu-id="534cd-206">The following fiscal integration samples are currently available in the Retail SDK that is released with Retail:</span></span>

- [<span data-ttu-id="534cd-207">Fiskalinio spausdintuvo integracijos pavyzdys (Italija)</span><span class="sxs-lookup"><span data-stu-id="534cd-207">Fiscal printer integration sample for Italy</span></span>](emea-ita-fpi-sample.md)
- [<span data-ttu-id="534cd-208">Fiskalinio spausdintuvo integracijos pavyzdys (Lenkija)</span><span class="sxs-lookup"><span data-stu-id="534cd-208">Fiscal printer integration sample for Poland</span></span>](emea-pol-fpi-sample.md)
- [<span data-ttu-id="534cd-209">Fiskalinės registracijos paslaugos integravimo pavyzdys, skirtas Austrijai</span><span class="sxs-lookup"><span data-stu-id="534cd-209">Fiscal registration service integration sample for Austria</span></span>](emea-aut-fi-sample.md)
- [<span data-ttu-id="534cd-210">Fiskalinės registracijos paslaugos integravimo pavyzdys, skirtas Čekijos Respublikai</span><span class="sxs-lookup"><span data-stu-id="534cd-210">Fiscal registration service integration sample for Czech Republic</span></span>](emea-cze-fi-sample.md)

<span data-ttu-id="534cd-211">Toliau nurodyta fiskalinės integracijos funkcija taip pat teikiama „Retail SDK“, bet šiuo metu ji nenaudoja fiskalinės integracijos sistemos.</span><span class="sxs-lookup"><span data-stu-id="534cd-211">The following fiscal integration functionality is also available in the Retail SDK but doesn't currently take advantage of the fiscal integration framework.</span></span> <span data-ttu-id="534cd-212">Šios funkcijos perkėlimas į fiskalinės integracijos sistemą planuojama vėlesniuose naujinimuose.</span><span class="sxs-lookup"><span data-stu-id="534cd-212">Migration of this functionality to the fiscal integration framework is planned for later updates.</span></span>

- [<span data-ttu-id="534cd-213">Prancūzijos skaitmeninis parašas</span><span class="sxs-lookup"><span data-stu-id="534cd-213">Digital signature for France</span></span>](emea-fra-cash-registers.md)
- [<span data-ttu-id="534cd-214">Norvegijos skaitmeninis parašas</span><span class="sxs-lookup"><span data-stu-id="534cd-214">Digital signature for Norway</span></span>](emea-nor-cash-registers.md)
- [<span data-ttu-id="534cd-215">Švedijos kontrolės įtaiso integracijos pavyzdys</span><span class="sxs-lookup"><span data-stu-id="534cd-215">Control unit integration sample for Sweden</span></span>](./retail-sdk-control-unit-sample.md)
