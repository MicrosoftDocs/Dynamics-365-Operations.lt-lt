---
title: Optimalaus persidengiančių nuolaidų derinio nustatymas
description: Kai nuolaidos persidengia, turite nustatyti persidengiančių nuolaidų derinį, kurį naudojant bus sukuriama mažiausia bendroji operacijos suma arba didžiausia bendroji nuolaidos suma. Kai nuolaidos suma kinta priklausomai nuo įsigytų produktų kainos, pavyzdžiui, kaip dažnai pasitaikančiu mažmeninės prekybos nuolaidų atveju „Pirkdami 1 gaukite 1 X procentų nuolaidą“ (BOGO), šis procesas tampa kombinacinio optimizavimo problema.
author: kfend
manager: AnnBe
ms.date: 06/20/2017
ms.topic: article
ms.prod: ''
ms.service: dynamics-365-retail
ms.technology: ''
ms.search.form: RetailParameters, RetailPeriodicDiscount,
audience: Application User, IT Pro
ms.reviewer: josaw
ms.custom: 89643
ms.assetid: 09843c9a-3e19-4e4a-a8ce-80650f2095f9
ms.search.region: global
ms.search.industry: Retail
ms.author: kfend
ms.search.validFrom: 2016-05-31
ms.dyn365.ops.version: AX 7.0.1
ms.openlocfilehash: fee9289820d3df821036412147994e227d68d1dc
ms.sourcegitcommit: eaf330dbee1db96c20d5ac479f007747bea079eb
ms.translationtype: HT
ms.contentlocale: lt-LT
ms.lasthandoff: 02/15/2021
ms.locfileid: "5257176"
---
# <a name="determine-the-optimal-combination-of-overlapping-discounts"></a><span data-ttu-id="b43b0-104">Optimalaus persidengiančių nuolaidų derinio nustatymas</span><span class="sxs-lookup"><span data-stu-id="b43b0-104">Determine the optimal combination of overlapping discounts</span></span>

[!include [banner](includes/banner.md)]

<span data-ttu-id="b43b0-105">Kai nuolaidos persidengia, turite nustatyti persidengiančių nuolaidų derinį, kurį naudojant bus sukuriama mažiausia bendroji operacijos suma arba didžiausia bendroji nuolaidos suma.</span><span class="sxs-lookup"><span data-stu-id="b43b0-105">When discounts overlap, you must determine the combination of overlapping discounts that will produce the lowest transaction total or the highest total discount.</span></span> <span data-ttu-id="b43b0-106">Kai nuolaidos suma kinta priklausomai nuo įsigytų produktų kainos, pavyzdžiui, kaip dažnai pasitaikančiu mažmeninės prekybos nuolaidų atveju „Pirkdami 1 gaukite 1 X procentų nuolaidą“ (BOGO), šis procesas tampa kombinacinio optimizavimo problema.</span><span class="sxs-lookup"><span data-stu-id="b43b0-106">When the discount amount varies according to the price of the products that are purchased, such as in the common "Buy 1, get 1 X percent off" (BOGO) retail discount, this process becomes an issue of combinatorial optimization.</span></span>

<span data-ttu-id="b43b0-107">Šis straipsnis taikomas programai „Microsoft Dynamics AX 2012 R3“ su „KB 3105973“ (išleista 2015 m. lapkričio 2 d.) arba naujesnei versijai ir „Dynamics 365 Commerce“.</span><span class="sxs-lookup"><span data-stu-id="b43b0-107">This article applies to Microsoft Dynamics AX 2012 R3 with KB 3105973 (released November 2, 2015) or later, and to Dynamics 365 Commerce.</span></span> <span data-ttu-id="b43b0-108">Norėdami nustatyti, kad nuolaidų persidengimo derinys būtų taikomas reikiamu laiku, pristatėme persidengiančių nuolaidų taikymo metodą.</span><span class="sxs-lookup"><span data-stu-id="b43b0-108">To determine the combination overlapping discounts to apply in a timely manner, we have introduced a method for applying overlapping discounts.</span></span> <span data-ttu-id="b43b0-109">Šį metodą vadiname **ribos vertės vertinimas**.</span><span class="sxs-lookup"><span data-stu-id="b43b0-109">We call this new method **marginal value ranking**.</span></span> <span data-ttu-id="b43b0-110">Ribos vertės vertinimas naudojamas tada, kai laikas, reikalingas norint įvertinti galimus persidengiančių nuolaidų derinius, viršija ribinę reikšmę, kurią galima sukonfigūruoti puslapyje **„Commerce“ parametrai**.</span><span class="sxs-lookup"><span data-stu-id="b43b0-110">Marginal value ranking is used when the time that is required in order to evaluate the possible combinations of overlapping discounts exceeds a threshold that is configurable on the **Commerce parameters** page.</span></span> <span data-ttu-id="b43b0-111">Taikant ribos vertės vertinimo metodą apskaičiuojama kiekvienos persidengiančios nuolaidos vertė taikant nuolaidos vertę bendrai naudojamiems produktams.</span><span class="sxs-lookup"><span data-stu-id="b43b0-111">In the marginal value ranking method, a value is calculated for each overlapping discount by using the discount's value on the shared products.</span></span> <span data-ttu-id="b43b0-112">Persidengiančios nuolaidos taikomos nuo didžiausios santykinės vertės iki mažiausios santykinės vertės.</span><span class="sxs-lookup"><span data-stu-id="b43b0-112">The overlapped discounts are then applied from the highest relative value to the lowest relative value.</span></span> <span data-ttu-id="b43b0-113">Išsamią informaciją apie naują metodą rasite toliau šiame straipsnyje pateiktame skyriuje „Ribos vertė“.</span><span class="sxs-lookup"><span data-stu-id="b43b0-113">For details about the new method, see the "Marginal value" section, later in this article.</span></span> <span data-ttu-id="b43b0-114">Ribos vertės vertinimas nenaudojamas, kai produkto nuolaidos sumoms neturi įtakos kitas operacijos produktas.</span><span class="sxs-lookup"><span data-stu-id="b43b0-114">Marginal value ranking isn't used when the discount amounts for a product aren't affected by another product in the transaction.</span></span> <span data-ttu-id="b43b0-115">Pavyzdžiui, šis metodas nenaudojamas dviems paprastoms nuolaidoms arba paprastai nuolaidai ir vieno produkto kiekio nuolaidai.</span><span class="sxs-lookup"><span data-stu-id="b43b0-115">For example, this method isn't used for two simple discounts, or for a simple discount and a single product quantity discount.</span></span>

## <a name="discount-examples"></a><span data-ttu-id="b43b0-116">Nuolaidų pavyzdžiai</span><span class="sxs-lookup"><span data-stu-id="b43b0-116">Discount examples</span></span>

<span data-ttu-id="b43b0-117">Bendram produktų rinkiniui galite sukurti neribotą nuolaidų skaičių.</span><span class="sxs-lookup"><span data-stu-id="b43b0-117">You can create an unlimited number of discounts on a common set of products.</span></span> <span data-ttu-id="b43b0-118">Tačiau, kadangi nėra apribojimo, bandant apskaičiuoti nuolaidas, kurios turėtų būti naudojamos įvairiems produktams, gali atsirasti našumo trikčių.</span><span class="sxs-lookup"><span data-stu-id="b43b0-118">However, because there is no limit, performance issues can occur when you try to calculate the discounts that should be used on the various products.</span></span> <span data-ttu-id="b43b0-119">Toliau pateikiamuose pavyzdžiuose ši problema pavaizduota išsamiau.</span><span class="sxs-lookup"><span data-stu-id="b43b0-119">The following examples illustrate this issue in more detail.</span></span> <span data-ttu-id="b43b0-120">1 pavyzdyje pradedame su dviem produktais ir dviem persidengiančiomis nuolaidomis.</span><span class="sxs-lookup"><span data-stu-id="b43b0-120">In example 1, we start with two products and two overlapping discounts.</span></span> <span data-ttu-id="b43b0-121">2 pavyzdyje rodoma, kaip problema didėja įtraukiant daugiau produktų.</span><span class="sxs-lookup"><span data-stu-id="b43b0-121">Then, in example 2, we show how the issue evolves as more products are added.</span></span>

### <a name="example-1-two-products-and-two-discounts"></a><span data-ttu-id="b43b0-122">1 pavyzdys: du produktai ir dvi nuolaidos</span><span class="sxs-lookup"><span data-stu-id="b43b0-122">Example 1: Two products and two discounts</span></span>

<span data-ttu-id="b43b0-123">Šiame pavyzdyje norint, kad būtų taikoma kiekviena nuolaida, reikia dviejų produktų ir nuolaidų negalima sujungti.</span><span class="sxs-lookup"><span data-stu-id="b43b0-123">In this example, two products are required in order to qualify for each discount, and the discounts can't be combined.</span></span> <span data-ttu-id="b43b0-124">Šio pavyzdžio nuolaidos yra nuolaidos **Geriausia kaina**.</span><span class="sxs-lookup"><span data-stu-id="b43b0-124">The discounts in this example are **Best price** discounts.</span></span> <span data-ttu-id="b43b0-125">Abiems produktams gali būti taikomos abi nuolaidos.</span><span class="sxs-lookup"><span data-stu-id="b43b0-125">Both products qualify for both discounts.</span></span> <span data-ttu-id="b43b0-126">Toliau nurodomos dvi nuolaidos.</span><span class="sxs-lookup"><span data-stu-id="b43b0-126">Here are the two discounts.</span></span>

![Dviejų geriausių kainos nuolaidų pavyzdys](./media/overlapping-discount-combo-01.jpg)

<span data-ttu-id="b43b0-128">Kuri iš šių dviejų produktų nuolaidų bus geresnė, priklauso nuo abiejų produktų kainos.</span><span class="sxs-lookup"><span data-stu-id="b43b0-128">For any two products, the better of these two discounts depends on the prices of the two products.</span></span> <span data-ttu-id="b43b0-129">Kai abiejų produktų kaina lygi arba beveik lygi, geriau naudoti 1 nuolaidą.</span><span class="sxs-lookup"><span data-stu-id="b43b0-129">When the price of both products is equal or almost equal, discount 1 is better.</span></span> <span data-ttu-id="b43b0-130">Kai vieno produkto kaina žymiai mažesnė negu kito produkto kaina, geriau naudoti 2 nuolaidą.</span><span class="sxs-lookup"><span data-stu-id="b43b0-130">When the price of one product is significantly less than the price of the other product, discount 2 is better.</span></span> <span data-ttu-id="b43b0-131">Toliau pateikiama šių dviejų nuolaidų vertinimo viena kitos atžvilgiu matematinė taisyklė.</span><span class="sxs-lookup"><span data-stu-id="b43b0-131">Here is the mathematical rule for evaluating these two discounts against each other.</span></span>

![Nuolaidų įvertinimo taisyklė](./media/overlapping-discount-combo-02.jpg)

> [!NOTE]
> <span data-ttu-id="b43b0-133">Kai 1 produkto kaina yra lygi dviem trečdaliams 2 produkto kainos, nuolaidos yra vienodos.</span><span class="sxs-lookup"><span data-stu-id="b43b0-133">When the price of product 1 is equal to two-thirds of the price of product 2, the two discounts are equal.</span></span> <span data-ttu-id="b43b0-134">Šiame pavyzdyje 1 nuolaidos įsigaliojimo procentinė dalis kinta nuo kelių procentų (kai dviejų produktų kainos itin skiriasi viena nuo kitos) iki maksimalios 25 procentų procentinės dalies (kai dviejų produktų kaina vienoda).</span><span class="sxs-lookup"><span data-stu-id="b43b0-134">In this example, the effective discount percentage for discount 1 varies from a few percent (when the prices of the two products are far apart) to a maximum of 25 percent (when the two products have the same price).</span></span> <span data-ttu-id="b43b0-135">2 nuolaidos įsigaliojimo procentinė dalis yra fiksuota.</span><span class="sxs-lookup"><span data-stu-id="b43b0-135">The effective discount percentage for discount 2 is fixed.</span></span> <span data-ttu-id="b43b0-136">Ji visada lygi 20 procentų.</span><span class="sxs-lookup"><span data-stu-id="b43b0-136">It's always 20 percent.</span></span> <span data-ttu-id="b43b0-137">Kadangi 1 nuolaidos įsigaliojimo procentinės dalies intervalas gali būti didesnis arba mažesnis už 2 nuolaidą, geriausia nuolaida priklauso nuo dviejų produktų kainos, kuriems turi būti taikoma nuolaida.</span><span class="sxs-lookup"><span data-stu-id="b43b0-137">Because the effective discount percentage for discount 1 has a range that can be more than or less than discount 2, the best discount depends on the prices of the two products that must be discounted.</span></span> <span data-ttu-id="b43b0-138">Šiame pavyzdyje skaičiavimas atliekamas greitai, nes taikomos tik dvi nuolaidos ir tik dviems produktams.</span><span class="sxs-lookup"><span data-stu-id="b43b0-138">In this example, the calculation is completed quickly, because only two discounts are applied on only two products.</span></span> <span data-ttu-id="b43b0-139">Galimi du deriniai: vieną kartą taikoma 1 nuolaida arba vieną kartą taikoma 2 nuolaida.</span><span class="sxs-lookup"><span data-stu-id="b43b0-139">There are only two possible combinations: one application of discount 1 or one application of discount 2.</span></span> <span data-ttu-id="b43b0-140">Nėra derinių, kuriuos reikėtų apskaičiuoti.</span><span class="sxs-lookup"><span data-stu-id="b43b0-140">There are no permutations to calculate.</span></span> <span data-ttu-id="b43b0-141">Kiekvienos nuolaidos vertė apskaičiuojama naudojant abu produktus ir naudojama didžiausia nuolaida.</span><span class="sxs-lookup"><span data-stu-id="b43b0-141">The value of each discount is calculated by using both products, and the best discount is used.</span></span>

### <a name="example-2-four-products-and-two-discounts"></a><span data-ttu-id="b43b0-142">2 pavyzdys: keturi produktai ir dvi nuolaidos</span><span class="sxs-lookup"><span data-stu-id="b43b0-142">Example 2: Four products and two discounts</span></span>

<span data-ttu-id="b43b0-143">Toliau bus naudojami keturi produktai ir tos pačios dvi nuolaidos.</span><span class="sxs-lookup"><span data-stu-id="b43b0-143">Next, we will use four products and the same two discounts.</span></span> <span data-ttu-id="b43b0-144">Visiems keturiems produktams gali būti taikomos abi nuolaidos.</span><span class="sxs-lookup"><span data-stu-id="b43b0-144">All four products qualify for both discounts.</span></span> <span data-ttu-id="b43b0-145">Yra dvylika galimų derinių.</span><span class="sxs-lookup"><span data-stu-id="b43b0-145">There are twelve possible combinations.</span></span> <span data-ttu-id="b43b0-146">Galiausiai dvi nuolaidos bus taikomos vienu iš šių trijų derinių: du kartus taikoma 1 nuolaida, du kartus taikoma 2 nuolaida arba vieną kartą taikoma 1 nuolaida ir vieną kartą taikoma 2 nuolaida.</span><span class="sxs-lookup"><span data-stu-id="b43b0-146">In the end, two discounts will be applied to the transaction in one of three combinations: two applications of discount 1, two applications of discount 2, or one application of discount 1 and one application of discount 2.</span></span> <span data-ttu-id="b43b0-147">Norėdami pavaizduoti galimus derinius peržiūrėsime du skirtingus iš keturių skirtingų kainų produktų sudarytus rinkinius.</span><span class="sxs-lookup"><span data-stu-id="b43b0-147">To illustrate the possible combinations, we will look at two different sets of four products that have different prices:</span></span>

- <span data-ttu-id="b43b0-148">Visų produktų kaina vienoda – 15,00 dol.</span><span class="sxs-lookup"><span data-stu-id="b43b0-148">All four products have the same price, $15.00.</span></span> <span data-ttu-id="b43b0-149">Šiuo atveju geriausias nuolaidų derinys yra du kartus taikoma 1 nuolaida.</span><span class="sxs-lookup"><span data-stu-id="b43b0-149">In this case, the best discount combination is two applications of discount 1.</span></span> <span data-ttu-id="b43b0-150">Du produktai bus parduodami be nuolaidos, o du – su 50 proc. nuolaida.</span><span class="sxs-lookup"><span data-stu-id="b43b0-150">Two products will be full price, and two will be 50 percent off.</span></span> <span data-ttu-id="b43b0-151">Bendra operacijos nuolaidos suma yra 45 dol. (15 + 15 + 7,50 + 7,50), o tai yra 15 dol. (25 procentų) nuolaida nuo bendros 60 dol. siekiančios sumos be nuolaidos.</span><span class="sxs-lookup"><span data-stu-id="b43b0-151">The discounted total for the transaction is $45 (15 + 15 + 7.50 + 7.50), which is $15 (25 percent) off the undiscounted total of $60.</span></span> <span data-ttu-id="b43b0-152">2 nuolaida yra tik 12 dol. (20 procentų).</span><span class="sxs-lookup"><span data-stu-id="b43b0-152">Discount 2 is only $12 (20 percent).</span></span>
- <span data-ttu-id="b43b0-153">Du produktai kainuoja po 20 dol., vienas produktas kainuoja 15 dol. ir vienas produktas – 5 dol.</span><span class="sxs-lookup"><span data-stu-id="b43b0-153">Two products are $20 each, one product is $15, and one product is $5.</span></span> <span data-ttu-id="b43b0-154">Šiuo atveju geriausias nuolaidų derinys yra vieną kartą taikoma 2 nuolaida ir vieną kartą taikoma 1 nuolaida.</span><span class="sxs-lookup"><span data-stu-id="b43b0-154">In this case, the best discount combination is one application of discount 2 and one application of discount 1.</span></span> <span data-ttu-id="b43b0-155">Šios nuolaidos pavaizduotos toliau pateiktose lentelėse.</span><span class="sxs-lookup"><span data-stu-id="b43b0-155">The following tables illustrates the discounts.</span></span>

<span data-ttu-id="b43b0-156">Norėdami perskaityti šias lenteles, naudokite vieną produktą iš eilutės ir vieną produktą iš stulpelio.</span><span class="sxs-lookup"><span data-stu-id="b43b0-156">To read the tables, use one product from a row and one product from a column.</span></span> <span data-ttu-id="b43b0-157">Pavyzdžiui, 1 nuolaidos lentelėje sujungę du 20 dol. vertės produktus gaunate 10 dol. nuolaidą.</span><span class="sxs-lookup"><span data-stu-id="b43b0-157">For example, in the table for discount 1, when you combine the two $20 products, you get $10 off.</span></span> <span data-ttu-id="b43b0-158">2 nuolaidos lentelėje sujungę 15 dol. ir 5 dol. vertės produktus gaunate 4 dol. nuolaidą.</span><span class="sxs-lookup"><span data-stu-id="b43b0-158">In the table for discount 2, when you combine the $15 product and the $5 product, you get $4 off.</span></span>

![Pavyzdys, naudojantis keturis produktus, kuriems taikomos dvi tos pačios nuolaidos](./media/overlapping-discount-combo-03.jpg)

<span data-ttu-id="b43b0-160">Pirmiausia randame didžiausią galimą nuolaidą, kuri gali būti pritaikyta bet kuriems dviem produktams naudojant bet kurią nuolaidą.</span><span class="sxs-lookup"><span data-stu-id="b43b0-160">First, we find the largest discount that is available from any two products by using either discount.</span></span> <span data-ttu-id="b43b0-161">Dviejose lentelėse nurodomos visų galimų derinių iš dviejų produktų nuolaidos sumos.</span><span class="sxs-lookup"><span data-stu-id="b43b0-161">The two tables show the discount amount for all combinations of the two products.</span></span> <span data-ttu-id="b43b0-162">Pilkos spalvos lentelių dalyse nurodomi atvejai, kai produktas susiejamas pats su savimi, ko padaryti mes negalime, arba kai du produktai siejami atvirkštiniu būdu ir gaunama ta pati nuolaidos suma, kurios galima nepaisyti.</span><span class="sxs-lookup"><span data-stu-id="b43b0-162">The shaded portions of the tables represent either cases where a product is paired with itself, which we can't do, or a reverse pairing of two products that produces the same discount amount and can be ignored.</span></span> <span data-ttu-id="b43b0-163">Žiūrėdami į lenteles galite pamatyti, kad 1 nuolaida, kuri taikoma dviems 20 dol. vertės prekėms, yra didžiausia nuolaida, kuri gali būti taikoma bet kuriam iš keturių produktų.</span><span class="sxs-lookup"><span data-stu-id="b43b0-163">By looking at the tables, you can see that discount 1 for the two $20 items is the largest discount that is available for either discount on all four products.</span></span> <span data-ttu-id="b43b0-164">(Ši nuolaida pirmoje lentelėje paryškinama žalia spalva.) Taigi lieka tik 15 dol. vertės produktas ir 5 dol. vertės produktas.</span><span class="sxs-lookup"><span data-stu-id="b43b0-164">(This discount is highlighted in green in the first table.) That leaves only the $15 product and the $5 product.</span></span> <span data-ttu-id="b43b0-165">Dar kartą pažvelgę į dvi lenteles galite pamatyti, kad šiems dviems produktams 1 nuolaida suteikia 2,50 dol. nuolaidą, o 2 nuolaida suteikia 4 dol. nuolaidą.</span><span class="sxs-lookup"><span data-stu-id="b43b0-165">By looking at the two tables again, you can see that, for these two products, discount 1 gives a $2.50 discount, whereas discount 2 gives a $4 discount.</span></span> <span data-ttu-id="b43b0-166">Nodėl mes pasirenkame 2 nuolaidą.</span><span class="sxs-lookup"><span data-stu-id="b43b0-166">Therefore, we select discount 2.</span></span> <span data-ttu-id="b43b0-167">Bendra nuolaida sudaro 14 dol.</span><span class="sxs-lookup"><span data-stu-id="b43b0-167">The total discount is $14.</span></span> <span data-ttu-id="b43b0-168">Siekiant, kad būtų lengviau įsivaizduoti tai, kas pasakyta anksčiau, pateikiamos dvi papildomos lentelės, kuriose nurodomos visų galimų derinių iš dviejų produktų 1 ir 2 nuolaidos įsigaliojimo procentinės dalys.</span><span class="sxs-lookup"><span data-stu-id="b43b0-168">To make this discussion easier to visualize, here are two additional tables that show the effective discount percentage for all possible two-product combinations for both discount 1 and discount 2.</span></span> <span data-ttu-id="b43b0-169">Įtraukiama tik pusė derinių sąrašo, nes išdėstymo tvarka, pagal kurią dviems produktams pritaikomos šios dvi nuolaidos, yra nesvarbi.</span><span class="sxs-lookup"><span data-stu-id="b43b0-169">Only half the list of combinations is included, because, for these two discounts, the order in which the two products are put into the discount doesn't matter.</span></span> <span data-ttu-id="b43b0-170">Didžiausia nuolaidos įsigaliojimo procentinė dalis (25 procentai) paryškinama žalia spalva, o mažiausia nuolaidos įsigaliojimo procentinė dalis (10 procentų) paryškinama raudona spalva.</span><span class="sxs-lookup"><span data-stu-id="b43b0-170">The highest effective discount (25 percent) is highlighted in green, and the lowest effective discount (10 percent) is highlighted in red.</span></span>

![Nuolaidos įsigaliojimo procentas, skirtas visiems abiejų nuolaidų dviejų produktų deriniams](./media/overlapping-discount-combo-04.jpg)

> [!NOTE]
> <span data-ttu-id="b43b0-172">Kai kainos skiriasi ir konkuruoja dvi ar daugiau nuolaidų, vienintelis būdas užtikrinti geriausią nuolaidų derinį yra įvertinti abi nuolaidas ir jas palyginti.</span><span class="sxs-lookup"><span data-stu-id="b43b0-172">When prices vary, and two or more discount compete, the only way to guarantee the best combination of discounts is to evaluate both discounts and compare them.</span></span>

## <a name="total-possible-combinations"></a><span data-ttu-id="b43b0-173">Visos galimos kombinacijos</span><span class="sxs-lookup"><span data-stu-id="b43b0-173">Total possible combinations</span></span>

<span data-ttu-id="b43b0-174">Šiame skyriuje tęsiamas ankstesniame skyriuje pateikto pavyzdžio aprašymas.</span><span class="sxs-lookup"><span data-stu-id="b43b0-174">This section continues the example from the previous section.</span></span> <span data-ttu-id="b43b0-175">Įtrauksime daugiau produktų ir kitą nuolaidą ir paziuresime, kiek turi būti apskaičiuojama ir palyginama derinių.</span><span class="sxs-lookup"><span data-stu-id="b43b0-175">We will add more products and another discount, and see how many combinations must be calculated and compared.</span></span> <span data-ttu-id="b43b0-176">Toliau pateiktoje lentelėje nurodomas galimų nuolaidų derinių skaičius, kai didėja produkto kiekis.</span><span class="sxs-lookup"><span data-stu-id="b43b0-176">The following table shows the number of possible discount combinations as the product quantity increases.</span></span> <span data-ttu-id="b43b0-177">Lentelėje pavaizduota, kas įvyksta, kai yra dvi persidengiančios nuolaidos, kaip nurodyta ankstesniame pavyzdyje, ir kai yra trys persidengiančios nuolaidos.</span><span class="sxs-lookup"><span data-stu-id="b43b0-177">The table shows what happens both when there are two overlapping discounts, as in the previous example, and when there are three overlapping discounts.</span></span> <span data-ttu-id="b43b0-178">Turimų įvertinti galimų nuolaidų derinių skaičius greitai tampa toks, kurio apskaičiuoti ir pakankamai greitai palyginti, kad būtų tinkamas mažmeninės prekybos operacijoms, negali net spartus kompiuteris.</span><span class="sxs-lookup"><span data-stu-id="b43b0-178">The number of possible discount combinations that must be evaluated soon exceeds what even a fast computer can calculate and compare quickly enough to be acceptable for retail transactions.</span></span>

![Galimų nuolaidų derinių skaičius, kai didėja produkto kiekis](./media/overlapping-discount-combo-05.jpg)

<span data-ttu-id="b43b0-180">Kai taikomos didesnės nuolaidos arba daugiau persidengiančių nuolaidų, bendras galimų nuolaidų derinių skaičius greitai pasiekia milijoną, o laikas, kurio reikia norint įvertinti ir pasirinkti geriausią derinį, greitai tampa pastebimas.</span><span class="sxs-lookup"><span data-stu-id="b43b0-180">When even larger quantities or more overlapping discounts are applied, the total number of possible discount combinations quickly goes into the millions, and the time that is required in order to evaluate and select the best possible combination quickly becomes noticeable.</span></span> <span data-ttu-id="b43b0-181">Kainų mechanizme buvo atliktas optimizavimas tam, kad būtų sumažintas bendras derinių, kuriuos reikia įvertinti, skaičius.</span><span class="sxs-lookup"><span data-stu-id="b43b0-181">Some optimizations have been done in the price engine to reduce the total number of combinations that must be evaluated.</span></span> <span data-ttu-id="b43b0-182">Tačiau kadangi persidengiančių nuolaidų skaičius ir operacijos kiekiai yra riboti, kiekvieną kartą esant persidengiančių nuolaidų turės būti įvertinamas didelis derinių skaičius.</span><span class="sxs-lookup"><span data-stu-id="b43b0-182">However, because the number overlapping discounts and the quantities in a transaction aren't limited, a large number of combinations will always have to be evaluated whenever there are overlapping discounts.</span></span> <span data-ttu-id="b43b0-183">Ši problema sprendžiama taikant ribos vertės vertinimo metodą.</span><span class="sxs-lookup"><span data-stu-id="b43b0-183">This issue is the issue that the marginal value ranking method addresses.</span></span>

## <a name="marginal-value-method"></a><span data-ttu-id="b43b0-184">Ribos vertės metodas</span><span class="sxs-lookup"><span data-stu-id="b43b0-184">Marginal value method</span></span>

<span data-ttu-id="b43b0-185">Norint išspręsti proporcingai didėjančio turimų įvertinti derinių skaičiaus problemą, galima naudoti optimizavimą, kurį naudojant apskaičiuojama kiekvieno bendrai naudojamo produkto, priklausančio produktų rinkiniui, kuriems gali būti taikomos dvi ar daugiau nuolaidų, nuolaidos vertė.</span><span class="sxs-lookup"><span data-stu-id="b43b0-185">To resolve the issue of an exponentially increasing number of combinations that must be evaluated, an optimization exists that calculates the value per shared product of each discount on the set of products that two or more discounts can be applied to.</span></span> <span data-ttu-id="b43b0-186">Ši vertė vadinama bendrai naudojamų produktų nuolaidos **ribos vertė**.</span><span class="sxs-lookup"><span data-stu-id="b43b0-186">We refer to this value as the **marginal value** of the discount for the shared products.</span></span> <span data-ttu-id="b43b0-187">Ribos vertė yra bendros produkto nuolaidos sumos padidėjimo vidurkis, kai bendrai naudojami produktai įtraukiami į kiekvieną nuolaidą.</span><span class="sxs-lookup"><span data-stu-id="b43b0-187">The marginal value is the average per product increase in the total discount amount when the shared products are included in each discount.</span></span> <span data-ttu-id="b43b0-188">Ribos vertė apskaičiuojama iš bendros nuolaidos sumos (DTotal) atimant nuolaidos sumą be bendrai naudojamų produktų (DMinus\\ Shared) ir padalinant skirtumą iš bendrai naudojamų produktų (ProductsShared) skaičiaus.</span><span class="sxs-lookup"><span data-stu-id="b43b0-188">The marginal value is calculated by taking the total discount amount (DTotal), subtracting the discount amount without the shared products (DMinus\\ Shared), and dividing that difference by the number of shared products (ProductsShared).</span></span>

![Ribinės vertės apskaičiavimo formulė](./media/overlapping-discount-combo-06.jpg)

<span data-ttu-id="b43b0-190">Apskaičiavus kiekvienos bendrai naudojamų produktų rinkinio nuolaidos ribinę vertę, bendrai naudojamiems produktams nuolaidos taikomos mažėjančia tvarka nuo didžiausios ribinės vertės iki mažiausios ribinės vertės.</span><span class="sxs-lookup"><span data-stu-id="b43b0-190">After the marginal value of each discount on a shared set of products is calculated, the discounts are applied to the shared products in order, exhaustively, from highest marginal value to lowest marginal value.</span></span> <span data-ttu-id="b43b0-191">Taikant šį metodą visos likusios nuolaidos galimybės nėra lyginamos kiekvieną kartą pritaikius vieną nuolaidos atvejį.</span><span class="sxs-lookup"><span data-stu-id="b43b0-191">For this method, all remaining discount possibilities aren't compared every time after a single instance of a discount is applied.</span></span> <span data-ttu-id="b43b0-192">Persidengiančios nuolaidos lyginamos vieną kartą, o po to taikomos iš eilės.</span><span class="sxs-lookup"><span data-stu-id="b43b0-192">Instead, the overlapping discounts are compared one time and then applied in order.</span></span> <span data-ttu-id="b43b0-193">Nėra atliekama jokių papildomų palyginimų.</span><span class="sxs-lookup"><span data-stu-id="b43b0-193">No additional comparisons are done.</span></span> <span data-ttu-id="b43b0-194">Galite sukonfigūruoti ribinę reikšmę, kad pereitumėte prie ribinės vertės metodo, esančio puslapyje **„Commerce“ parametrai**, skirtuke **Nuolaida**.</span><span class="sxs-lookup"><span data-stu-id="b43b0-194">You can configure the threshold to switch to the marginal value method on the **Discount** tab of the **Commerce parameters** page.</span></span> <span data-ttu-id="b43b0-195">Įvairiose mažmeninės prekybos rinkose laikas, kuris tinkamas apskaičiuoti bendrąją nuolaidos sumą, skiriasi.</span><span class="sxs-lookup"><span data-stu-id="b43b0-195">The acceptable time to calculate the total discount varies across retail industries.</span></span> <span data-ttu-id="b43b0-196">Tačiau šis laikas paprastai patenka į intervalą nuo dešimčių milisekundžių iki vienos sekundės.</span><span class="sxs-lookup"><span data-stu-id="b43b0-196">However, this time generally falls in the range of tens of milliseconds to one second.</span></span>


[!INCLUDE[footer-include](../includes/footer-banner.md)]