---
title: "Duomenų importavimo iš „SharePoint“ konfigūravimas"
description: "Šioje temoje paaiškinta, kaip importuoti duomenis iš „Microsoft SharePoint“."
author: NickSelin
manager: AnnBe
ms.date: 05/21/2018
ms.topic: article
ms.prod: 
ms.service: dynamics-ax-platform
ms.technology: 
audience: Application User, Developer, IT Pro
ms.reviewer: kfend
ms.search.scope: Core, Operations
ms.custom: 220314
ms.assetid: 2685df16-5ec8-4fd7-9495-c0f653e82567
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2018-04-01
ms.dyn365.ops.version: Release 8.0
ms.translationtype: HT
ms.sourcegitcommit: 2fc887668171175d436b9eb281a35c1c9d089591
ms.openlocfilehash: 4285db9c71208bce45d64933e692a25ef3f46b26
ms.contentlocale: lt-lt
ms.lasthandoff: 05/25/2018

---
# <a name="configure-data-import-from-sharepoint"></a><span data-ttu-id="c5688-103">Duomenų importavimo iš „SharePoint“ konfigūravimas</span><span class="sxs-lookup"><span data-stu-id="c5688-103">Configure data import from SharePoint</span></span>

[!include[banner](../includes/banner.md)]

<span data-ttu-id="c5688-104">Norėdami importuoti duomenis iš gaunamo failo naudodami elektroninių ataskaitų (ER) sistemą, turite konfigūruoti ER formatą, kuris palaiko importavimą, ir paleisti tipo **Į paskirties vietą** modelio susiejimą, kuris naudoja tą formatą kaip duomenų šaltinį.</span><span class="sxs-lookup"><span data-stu-id="c5688-104">To import data from an incoming file by using the Electronic reporting (ER) framework, you must configure an ER format that supports the import and then run a model mapping of the **To destination** type that uses that format as a data source.</span></span> <span data-ttu-id="c5688-105">Norėdami importuoti duomenis, turite pereiti į failą, kurį norite importuoti.</span><span class="sxs-lookup"><span data-stu-id="c5688-105">To import data, you must navigate to the file that you want to import.</span></span> <span data-ttu-id="c5688-106">Gaunamą failą vartotojas gali pasirinkti rankiniu būdu.</span><span class="sxs-lookup"><span data-stu-id="c5688-106">The incoming file can be manually selected by user.</span></span> <span data-ttu-id="c5688-107">Su nauja ER galimybe palaikyti iš „Microsoft SharePoint“ importuojamus duomenis, šį procesą galima konfigūruoti kaip naudojamą be priežiūros.</span><span class="sxs-lookup"><span data-stu-id="c5688-107">With the new ER capability to support importing data from Microsoft SharePoint, this process can be configured as the unattended one.</span></span> <span data-ttu-id="c5688-108">Galite naudoti ER konfigūracijas norėdami duomenų importavimą atlikti iš failų, saugomų „Microsoft SharePoint“ aplankuose.</span><span class="sxs-lookup"><span data-stu-id="c5688-108">You can use ER configurations to perform data import from files that are stored in Microsoft SharePoint folders.</span></span> <span data-ttu-id="c5688-109">Šioje temoje paaiškinta, kaip atlikti importavimą iš „SharePoint“ į „Microsoft Dynamics 365 for Finance and Operations“.</span><span class="sxs-lookup"><span data-stu-id="c5688-109">This topic explains how to complete the import from SharePoint to Microsoft Dynamics 365 for Finance and Operations.</span></span> <span data-ttu-id="c5688-110">Pavyzdžiuose tiekėjo operacijos naudojamos kaip verslo duomenys.</span><span class="sxs-lookup"><span data-stu-id="c5688-110">The examples use vendor transactions as business data.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="c5688-111">Būtinieji komponentai</span><span class="sxs-lookup"><span data-stu-id="c5688-111">Prerequisites</span></span>
<span data-ttu-id="c5688-112">Norint įvykdyti šios temos pavyzdžių užduotis, reikia toliau nurodytų prieigų.</span><span class="sxs-lookup"><span data-stu-id="c5688-112">To complete the examples in this topic, you must have the following access:</span></span>

- <span data-ttu-id="c5688-113">Prieiga prie „Finance and Operations“ naudojant vieną iš tolesnių vaidmenų.</span><span class="sxs-lookup"><span data-stu-id="c5688-113">Access to Finance and Operations for one of the following roles:</span></span>

    - <span data-ttu-id="c5688-114">Elektroninės ataskaitos kūrėjas</span><span class="sxs-lookup"><span data-stu-id="c5688-114">Electronic reporting developer</span></span>
    - <span data-ttu-id="c5688-115">Elektroninės ataskaitos funkcijų konsultantas</span><span class="sxs-lookup"><span data-stu-id="c5688-115">Electronic reporting functional consultant</span></span>
    - <span data-ttu-id="c5688-116">Sistemos administratorius</span><span class="sxs-lookup"><span data-stu-id="c5688-116">System administrator</span></span>

- <span data-ttu-id="c5688-117">Prieiga prie „Microsoft SharePoint Server“ egzemplioriaus, kuris sukonfigūruotas naudoti su „Finance and Operations“</span><span class="sxs-lookup"><span data-stu-id="c5688-117">Access to the instance of Microsoft SharePoint Server that is configured for use with Finance and Operations</span></span>
- <span data-ttu-id="c5688-118">1099 mokėjimams naudojami ER formatas ir modelio konfigūracijos</span><span class="sxs-lookup"><span data-stu-id="c5688-118">ER format and model configurations for 1099 payments</span></span>

### <a name="create-required-er-configurations"></a><span data-ttu-id="c5688-119">Reikiamų ER konfigūracijų kūrimas</span><span class="sxs-lookup"><span data-stu-id="c5688-119">Create required ER configurations</span></span>
<span data-ttu-id="c5688-120">Leiskite užduočių vedlius **ER importavimo duomenys iš „Microsoft Excel“ failas**, kurie yra **7.5.4.3 Įsigyti / sukurti IT paslaugų ir sprendimų komponentų(10677)** verslo proceso dalis.</span><span class="sxs-lookup"><span data-stu-id="c5688-120">Play the **ER Import data from a Microsoft Excel file** task guides, which are part of the **7.5.4.3 Acquire/Develop IT service/solution components (10677)** business process.</span></span> <span data-ttu-id="c5688-121">Šie užduočių vedliai parodys jums ER konfigūracijų kūrimo ir naudojimo procesą, norint interaktyviai importuoti tiekėjo operacijas iš išorinių „Microsoft Excel“ failų.</span><span class="sxs-lookup"><span data-stu-id="c5688-121">These task guides walk you through the process of designing and using ER configurations to interactively import vendor transactions from external Microsoft Excel files.</span></span> <span data-ttu-id="c5688-122">Daugiau informacijos rasite [Gaunamų dokumentų analizė „Microsoft Excel“](parse-incoming-documents-excel.md).</span><span class="sxs-lookup"><span data-stu-id="c5688-122">For more information, see [Parse incoming documents in Microsoft Excel](parse-incoming-documents-excel.md).</span></span> <span data-ttu-id="c5688-123">Galiausiai turėsite:</span><span class="sxs-lookup"><span data-stu-id="c5688-123">Fianlly, you will have:</span></span>

- <span data-ttu-id="c5688-124">ER konfigūracijos:</span><span class="sxs-lookup"><span data-stu-id="c5688-124">ER configurations:</span></span>

    - <span data-ttu-id="c5688-125">ER modelio konfigūracija, **1099 mokėjimų modelis**</span><span class="sxs-lookup"><span data-stu-id="c5688-125">ER model configuration, **1099 Payments model**</span></span>
    - <span data-ttu-id="c5688-126">ER formato konfigūracija, **Tiekėjų operacijų importavimo iš „Excel“ formatas**</span><span class="sxs-lookup"><span data-stu-id="c5688-126">ER format configuration, **Format for importing vendors' transactions from Excel**</span></span>

<span data-ttu-id="c5688-127">[![ER konfigūracijos duomenims importuoti iš „SharePoint“](./media/GERImportFromSharePoint-01-Configurations.PNG)](./media/GERImportFromSharePoint-01-Configurations.PNG)</span><span class="sxs-lookup"><span data-stu-id="c5688-127">[![ER configurations for importing data from SharePoint](./media/GERImportFromSharePoint-01-Configurations.PNG)](./media/GERImportFromSharePoint-01-Configurations.PNG)</span></span>

- <span data-ttu-id="c5688-128">Gaunamo duomenų importavimo failo pavyzdys:</span><span class="sxs-lookup"><span data-stu-id="c5688-128">Sample of the incoming file for data import:</span></span>

    - <span data-ttu-id="c5688-129">„Excel“ failas **1099import-data.xlsx**, kuriame yra tiekėjo operacijos, importuotinos į „Finance and Operations“</span><span class="sxs-lookup"><span data-stu-id="c5688-129">Excel file **1099import-data.xlsx**, with vendor transactions that should be imported into Finance and Operations</span></span>

<span data-ttu-id="c5688-130">[![„Microsoft Excel“ failo, skirto importuoti iš „SharePoint“ pavyzdys](./media/GERImportFromSharePoint-02-Excel.PNG)](./media/GERImportFromSharePoint-02-Excel.PNG)</span><span class="sxs-lookup"><span data-stu-id="c5688-130">[![Sample Microsoft Excel file for importing from SharePoint](./media/GERImportFromSharePoint-02-Excel.PNG)](./media/GERImportFromSharePoint-02-Excel.PNG)</span></span>

> [!NOTE]
> <span data-ttu-id="c5688-131">Tiekėjo operacijų importavimo formatas pasirenkamas kaip numatytasis modelio susiejimas.</span><span class="sxs-lookup"><span data-stu-id="c5688-131">The format for importing vendor transactions is selected as the default model mapping.</span></span> <span data-ttu-id="c5688-132">Todėl jei vykdote modelio susiejimą **1099 mokėjimų modelis** ir to modelio susiejimo tipas yra **Į paskirties vietą**, modelio susiejimas vykdo šį formatą importuojant duomenis iš išorinių failų.</span><span class="sxs-lookup"><span data-stu-id="c5688-132">Therefore, if you run a model mapping of the **1099 Payments model**, and that model mapping is of the **To destination** type, the model mapping runs this format to import data from external files.</span></span> <span data-ttu-id="c5688-133">Tada šie duomenys naudojami atnaujinant programos lenteles.</span><span class="sxs-lookup"><span data-stu-id="c5688-133">It then uses that data to update application tables.</span></span>

## <a name="configure-document-management-parameters"></a><span data-ttu-id="c5688-134">Dokumentų valdymo parametrų konfigūravimas</span><span class="sxs-lookup"><span data-stu-id="c5688-134">Configure Document management parameters</span></span>
1. <span data-ttu-id="c5688-135">Puslapyje **Dokumentų valdymo parametrai** sukonfigūruokite prieigą prie „SharePoint Server“ egzemplioriaus, kuris bus naudojamas įmonėje, prie kurios šiuo metu esate prisijungę.</span><span class="sxs-lookup"><span data-stu-id="c5688-135">On the **Document management parameters** page, configure access to the SharePoint Server instance that will be used by the company that you're currently signed in to.</span></span> <span data-ttu-id="c5688-136">Šiame pavyzdyje įmonė yra USMF.</span><span class="sxs-lookup"><span data-stu-id="c5688-136">In this example, the company is USMF.</span></span>
2. <span data-ttu-id="c5688-137">Patikrinkite ryšį su „SharePoint Server“ egzemplioriumi ir įsitikinkite, kad prieiga jums suteikta.</span><span class="sxs-lookup"><span data-stu-id="c5688-137">Test the connection to the SharePoint Server instance to make sure that you've been granted access.</span></span>

<span data-ttu-id="c5688-138">[![Dokumentų valdymo parametrai – „SharePoint“ serveris](./media/GERImportFromSharePoint-03-SharePointSetup.png)](./media/GERImportFromSharePoint-03-SharePointSetup.png)</span><span class="sxs-lookup"><span data-stu-id="c5688-138">[![Document management setting – SharePoint server](./media/GERImportFromSharePoint-03-SharePointSetup.png)](./media/GERImportFromSharePoint-03-SharePointSetup.png)</span></span>

3. <span data-ttu-id="c5688-139">Atidarykite sukonfigūruotą „SharePoint“ svetainę ir kurkite šiuos aplankus, kur galima saugoti gaunamus failus:</span><span class="sxs-lookup"><span data-stu-id="c5688-139">Open the configured SharePoint site, and create the following folders where the incoming files can be stored:</span></span>

    - <span data-ttu-id="c5688-140">Failų importavimo šaltinis (pagrindinis)</span><span class="sxs-lookup"><span data-stu-id="c5688-140">Files import source (main)</span></span>
    - <span data-ttu-id="c5688-141">Failų importavimo šaltinis (alternatyvus)</span><span class="sxs-lookup"><span data-stu-id="c5688-141">Files import source (alternative)</span></span>

<span data-ttu-id="c5688-142">[![Dokumentų valdymo parametrai – „SharePoint“ serveris](./media/GERImportFromSharePoint-04-SharePointFolder1.png)](./media/GERImportFromSharePoint-04-SharePointFolder1.png)</span><span class="sxs-lookup"><span data-stu-id="c5688-142">[![Document management setting – SharePoint server](./media/GERImportFromSharePoint-04-SharePointFolder1.png)](./media/GERImportFromSharePoint-04-SharePointFolder1.png)</span></span>

<span data-ttu-id="c5688-143">[![Dokumentų valdymo parametrai – „SharePoint“ serveris](./media/GERImportFromSharePoint-05-SharePointFolder2.png)](./media/GERImportFromSharePoint-05-SharePointFolder2.png)</span><span class="sxs-lookup"><span data-stu-id="c5688-143">[![Document management setting – SharePoint server](./media/GERImportFromSharePoint-05-SharePointFolder2.png)](./media/GERImportFromSharePoint-05-SharePointFolder2.png)</span></span>

4. <span data-ttu-id="c5688-144">„Finance and Operations“ puslapyje **Dokumentų tipai** sukurkite toliau nurodytus dokumentų tipus, kurie bus naudojami norint pasiekti ką tik sukurtus „SharePoint“ aplankus.</span><span class="sxs-lookup"><span data-stu-id="c5688-144">In Finance and Operations, on the **Document types** page, create the following document types that will be used to access the SharePoint folders that you just created:</span></span>

    - <span data-ttu-id="c5688-145">SP pagrindinis</span><span class="sxs-lookup"><span data-stu-id="c5688-145">SP Main</span></span>
    - <span data-ttu-id="c5688-146">SP alternatyvus</span><span class="sxs-lookup"><span data-stu-id="c5688-146">SP Alternative</span></span>

5. <span data-ttu-id="c5688-147">Sukurtiems dokumentų tipams lauke **Grupė** įveskite **Failas**, o lauke **Vieta** įveskite **„SharePoint“**.</span><span class="sxs-lookup"><span data-stu-id="c5688-147">For created document types, in the **Group** field, enter **File** and in the **Location** field, enter **SharePoint**.</span></span> <span data-ttu-id="c5688-148">Tuomet įveskite „SharePoint“ aplanko adresą:</span><span class="sxs-lookup"><span data-stu-id="c5688-148">Then enter the address of the SharePoint folder:</span></span>

    - <span data-ttu-id="c5688-149">Dokumento tipui **SP pagrindinis**: Failų importavimo šaltinis (pagrindinis)</span><span class="sxs-lookup"><span data-stu-id="c5688-149">For the **SP Main** document type: Files import source (main)</span></span>
    - <span data-ttu-id="c5688-150">Dokumento tipui **SP alternatyvus**: Failų importavimo šaltinis (alternatyvus)</span><span class="sxs-lookup"><span data-stu-id="c5688-150">For the **SP Alternative** document type: Files import source (alternative)</span></span>

<span data-ttu-id="c5688-151">[![„SharePoint“ parametras – naujas dokumento tipas](./media/GERImportFromSharePoint-06-SharePointDocumentTypesSetup.png)](./media/GERImportFromSharePoint-06-SharePointDocumentTypesSetup.png)</span><span class="sxs-lookup"><span data-stu-id="c5688-151">[![SharePoint setting – new document type](./media/GERImportFromSharePoint-06-SharePointDocumentTypesSetup.png)](./media/GERImportFromSharePoint-06-SharePointDocumentTypesSetup.png)</span></span>

## <a name="configure-er-sources-for-the-er-format"></a><span data-ttu-id="c5688-152">ER formato ER šaltinių konfigūravimas</span><span class="sxs-lookup"><span data-stu-id="c5688-152">Configure ER sources for the ER format</span></span>
1. <span data-ttu-id="c5688-153">Spustelėkite **Organizacijos administravimas** > **Elektroninės ataskaitos** > **Elektroninių ataskaitų šaltinis**.</span><span class="sxs-lookup"><span data-stu-id="c5688-153">Click **Organization administration** > **Electronic reporting** > **Electronic reporting source**.</span></span>
2. <span data-ttu-id="c5688-154">Puslapyje **Elektroninių ataskaitų šaltinis** konfigūruokite duomenų importavimo šaltinio failus naudodami sukonfigūruotą ER formatą.</span><span class="sxs-lookup"><span data-stu-id="c5688-154">On the **Electronic reporting source** page, configure the source files for data import by using the configured ER format.</span></span>
3. <span data-ttu-id="c5688-155">Nurodykite failo pavadinimo šabloną, kad būtų importuoti tik failai su .xlsx plėtiniu.</span><span class="sxs-lookup"><span data-stu-id="c5688-155">Define a file name mask, so that only files with the .xlsx extension are imported.</span></span> <span data-ttu-id="c5688-156">Failo pavadinimo šablonas yra pasirinktinis ir naudojamas tik tada, jei buvo nurodytas.</span><span class="sxs-lookup"><span data-stu-id="c5688-156">The file name mask is optional and is used only when it has been defined.</span></span> <span data-ttu-id="c5688-157">Galite nurodyti tik po vieną kiekvieno ER formato šabloną.</span><span class="sxs-lookup"><span data-stu-id="c5688-157">You can define only one mask for each ER format.</span></span>
4. <span data-ttu-id="c5688-158">Pasirinkite abu „SharePoint“ aplankus, kuriuos sukūrėte anksčiau.</span><span class="sxs-lookup"><span data-stu-id="c5688-158">Select both SharePoint folders that you created earlier.</span></span>

<span data-ttu-id="c5688-159">[![ER failų šaltinio parametras](./media/GERImportFromSharePoint-07-FormatSourceSetup.PNG)](./media/GERImportFromSharePoint-07-FormatSourceSetup.PNG)</span><span class="sxs-lookup"><span data-stu-id="c5688-159">[![ER files source setting](./media/GERImportFromSharePoint-07-FormatSourceSetup.PNG)](./media/GERImportFromSharePoint-07-FormatSourceSetup.PNG)</span></span>

> [!NOTE]
><span data-ttu-id="c5688-160">ER *šaltinis* nurodytas kiekvienai programos įmonei atskirai.</span><span class="sxs-lookup"><span data-stu-id="c5688-160">The ER *source* is defined for each application company individually.</span></span> <span data-ttu-id="c5688-161">Tačiau, ER *konfigūracijos* yra bendrai naudojamos keliose įmonėse.</span><span class="sxs-lookup"><span data-stu-id="c5688-161">By contrast, ER *configurations* are shared across companies.</span></span>

> [!NOTE]
> <span data-ttu-id="c5688-162">Panaikinus ER formato ER šaltinio parametrą, taip pat panaikinamos visų prijungtų failų būsenos (žr. toliau).</span><span class="sxs-lookup"><span data-stu-id="c5688-162">When you delete an ER source setting for an ER format, all connected file states (see below) are also deleted.</span></span>

## <a name="review-the-files-states-for-the-er-format"></a><span data-ttu-id="c5688-163">ER formato failų būsenų peržiūra</span><span class="sxs-lookup"><span data-stu-id="c5688-163">Review the files states for the ER format</span></span>
1. <span data-ttu-id="c5688-164">Puslapyje **Elektroninių ataskaitų šaltinis** pasirinkite **Šaltinių failų būsenos** norėdami peržiūrėti dabartinio ER formato sukonfigūruotų failų šaltinių turinį.</span><span class="sxs-lookup"><span data-stu-id="c5688-164">On the **Electronic reporting source** page, select **File states for the sources** to review the content of the configured file sources for the current ER format.</span></span>
2. <span data-ttu-id="c5688-165">Skyriuje **Failai** peržiūrėkite failų sąrašą.</span><span class="sxs-lookup"><span data-stu-id="c5688-165">In the **Files** section, review the list of files.</span></span> <span data-ttu-id="c5688-166">Šiame sąraše pristatomi šie elementai:</span><span class="sxs-lookup"><span data-stu-id="c5688-166">This list presents the following:</span></span>

    - <span data-ttu-id="c5688-167">Šaltinio failus, kurie taikomi pagal failo pavadinimo šabloną (jei failo pavadinimo šablonas nurodytas) ir kurie parengti duomenims importuoti.</span><span class="sxs-lookup"><span data-stu-id="c5688-167">Source files that are applicable, based on the file name mask (if a file name mask is defined), and that are ready for data import.</span></span> <span data-ttu-id="c5688-168">Šių failų skyrius **Importavimo formato šaltinių žurnalas** yra tuščias.</span><span class="sxs-lookup"><span data-stu-id="c5688-168">For these files, the **Sources log for the import format** section is blank.</span></span>
    - <span data-ttu-id="c5688-169">Anksčiau importuoti failai.</span><span class="sxs-lookup"><span data-stu-id="c5688-169">Previously imported files.</span></span> <span data-ttu-id="c5688-170">Kiekvienam iš šių failų skyriuje **Importavimo formato šaltinių žurnalas** galite peržiūrėti šio failo importavimo retrospektyvą.</span><span class="sxs-lookup"><span data-stu-id="c5688-170">For each of these files, in the **Sources log for the import format** section, you can review the history of import of this file.</span></span>

<span data-ttu-id="c5688-171">Be to, galite atidaryti puslapį **Šaltinių failų būsenos** pasirinkę **Organizacijos administravimas** \> **Elektroninės ataskaitos** \> **Šaltinių failų būsenos**.</span><span class="sxs-lookup"><span data-stu-id="c5688-171">You can also open the **File states for the sources** page by selecting **Organization administration** \> **Electronic reporting** \> **File states for the sources**.</span></span> <span data-ttu-id="c5688-172">Šiuo atveju puslapyje pateikiama informacija apie visų ER formatų failų šaltinius, kuriems failų šaltiniai buvo sukonfigūruoti įmonėje, prie kurios šiuo metu esate prisijungę.</span><span class="sxs-lookup"><span data-stu-id="c5688-172">In this case, the page provides information about file sources for all ER formats that file sources have been configured for in the company that you're currently signed in to.</span></span>

## <a name="import-data-from-excel-files-that-are-in-a-sharepoint-folder"></a><span data-ttu-id="c5688-173">Importuoti duomenis iš „Excel“ failų, esančių „SharePoint“ aplanke</span><span class="sxs-lookup"><span data-stu-id="c5688-173">Import data from Excel files that are in a SharePoint folder</span></span>
1. <span data-ttu-id="c5688-174">Programoje „SharePoint“ įkelkite „Microsoft Excel“ failą **1099import-data.xlsx**, kuriame yra tiekėjo operacijos, į anksčiau sukurtą „SharePoint“ aplanką **Failų importavimo šaltinis (pagrindinis)**.</span><span class="sxs-lookup"><span data-stu-id="c5688-174">In SharePoint, upload the Microsoft Excel file **1099import-data.xlsx** that contains vendor transactions to the **Files import source (main)** SharePoint folder that you created earlier.</span></span>

<span data-ttu-id="c5688-175">[![„SharePoint“ turinys – „Microsoft Excel“ failas, skirtas importuoti](./media/GERImportFromSharePoint-08-UploadFile.png)](./media/GERImportFromSharePoint-08-UploadFile.png)</span><span class="sxs-lookup"><span data-stu-id="c5688-175">[![SharePoint content – Microsoft Excel file for importing](./media/GERImportFromSharePoint-08-UploadFile.png)](./media/GERImportFromSharePoint-08-UploadFile.png)</span></span>

2. <span data-ttu-id="c5688-176">Sprendimo „Finance and Operations“ puslapyje **Šaltinių failų būsenos** pasirinkę **Atnaujinti** atnaujinkite puslapį.</span><span class="sxs-lookup"><span data-stu-id="c5688-176">In Finance and Operations, on the **File states for the sources** page, select **Refresh** to refresh the page.</span></span> <span data-ttu-id="c5688-177">Atkreipkite dėmesį, kad „Excel“ failo, kuris buvo įkeltas į „SharePoint“, šioje formoje būsena buvo **Parengta**.</span><span class="sxs-lookup"><span data-stu-id="c5688-177">Note that the Excel file that was uploaded to SharePoint appeared in this form with the status **Ready**.</span></span> <span data-ttu-id="c5688-178">Šiuo metu palaikomos šios būsenos:</span><span class="sxs-lookup"><span data-stu-id="c5688-178">The following statuses are currently supported:</span></span>

    - <span data-ttu-id="c5688-179">**Parengta** – automatiškai priskiriama kiekvienam naujam „SharePoint“ aplankui.</span><span class="sxs-lookup"><span data-stu-id="c5688-179">**Ready** - Assigned automatically for each new file in a SharePoint folder.</span></span> <span data-ttu-id="c5688-180">Ši būsena reiškia, kad failas parengtas importuoti.</span><span class="sxs-lookup"><span data-stu-id="c5688-180">This status means that the file is ready for import.</span></span>
    - <span data-ttu-id="c5688-181">**Importuojama** – priskiriama automatiškai pagal ER ataskaitą, kai failas bus užrakintas dėl importavimo proceso, kad jo nebūtų galima naudoti kituose procesuose (jei vienu metu veikia keletas jų).</span><span class="sxs-lookup"><span data-stu-id="c5688-181">**Importing** - Assigned automatically by an ER report when the file will be locked by the import process to prevent its usage by other processes (if many of them are running simultaneously).</span></span>
    - <span data-ttu-id="c5688-182">**Importuota** – priskiriama automatiškai pagal ER ataskaitą, kai failo importavimas sėkmingai baigtas.</span><span class="sxs-lookup"><span data-stu-id="c5688-182">**Imported** - Assigned automatically by an ER report when the file import is successfully completed.</span></span> <span data-ttu-id="c5688-183">Ši būsena reiškia, kad importuotas failas panaikintas iš sukonfigūruotų failų šaltinio („SharePoint“ aplanko).</span><span class="sxs-lookup"><span data-stu-id="c5688-183">This status means that the imported file has been deleted from the configured files source (SharePoint folder).</span></span>
    - <span data-ttu-id="c5688-184">**Nepavyko** – priskiriama automatiškai pagal ER ataskaitą, kai failo importavimas baigtas su klaidomis arba išimtimis.</span><span class="sxs-lookup"><span data-stu-id="c5688-184">**Failed** - Assigned automatically by an ER report when the file import completed with errors or exceptions.</span></span>
    - <span data-ttu-id="c5688-185">**Sulaikyta** – vartotojo priskiriama rankiniu būdu šioje formoje.</span><span class="sxs-lookup"><span data-stu-id="c5688-185">**On hold** - Assigned manually by user on this form.</span></span> <span data-ttu-id="c5688-186">Ši būsena reiškia, kad failas kol kas nebus importuojamas.</span><span class="sxs-lookup"><span data-stu-id="c5688-186">This status means that the file will not be imported for now.</span></span> <span data-ttu-id="c5688-187">Šią būseną galima naudoti norint atidėti kai kurių failų importavimą.</span><span class="sxs-lookup"><span data-stu-id="c5688-187">This status can be used to postpone the import of some files.</span></span>

<span data-ttu-id="c5688-188">[![Pasirinktų šaltinių ER failų būsenų puslapis](./media/GERImportFromSharePoint-09-FileStatesForm.png)](./media/GERImportFromSharePoint-09-FileStatesForm.png)</span><span class="sxs-lookup"><span data-stu-id="c5688-188">[![ER file states page for the selected sources](./media/GERImportFromSharePoint-09-FileStatesForm.png)](./media/GERImportFromSharePoint-09-FileStatesForm.png)</span></span>

## <a name="import-data-from-sharepoint-files"></a><span data-ttu-id="c5688-189">Duomenų importavimas iš „SharePoint“ failų</span><span class="sxs-lookup"><span data-stu-id="c5688-189">Import data from SharePoint files</span></span>
1. <span data-ttu-id="c5688-190">Atidarykite ER konfigūracijos medį, pasirinkite **1099 mokėjimų modelis** ir išplėskite ER modelio komponentų sąrašą.</span><span class="sxs-lookup"><span data-stu-id="c5688-190">Open the ER configurations tree, select the **1099 Payment model**, and expand the list of ER model components.</span></span>
2. <span data-ttu-id="c5688-191">Pasirinkę modelio susiejimo modelio pavadinimą atidarykite pasirinkto ER modelio konfigūracijos modelių susiejimo sąrašą.</span><span class="sxs-lookup"><span data-stu-id="c5688-191">Select the name of the model mapping to open the list of model mappings of the selected ER model configuration.</span></span>

<span data-ttu-id="c5688-192">[![Pasirinktų šaltinių ER failų būsenų puslapis](./media/GERImportFromSharePoint-10-SelectModelMapping.PNG)](./media/GERImportFromSharePoint-10-SelectModelMapping.PNG)</span><span class="sxs-lookup"><span data-stu-id="c5688-192">[![ER file states page for the selected sources](./media/GERImportFromSharePoint-10-SelectModelMapping.PNG)](./media/GERImportFromSharePoint-10-SelectModelMapping.PNG)</span></span>

3. <span data-ttu-id="c5688-193">Pasirinkę **Vykdyti** paleisite pasirinkto modelio susiejimą.</span><span class="sxs-lookup"><span data-stu-id="c5688-193">Select **Run** to run the selected model mapping.</span></span> <span data-ttu-id="c5688-194">Todėl, kad sukonfigūravote ER formato failų šaltinius, galite pagal poreikį keisti parametrą į parinktį **Failo šaltinis**.</span><span class="sxs-lookup"><span data-stu-id="c5688-194">Because you configured file sources for the ER format, you can change the setting of the **File source** option as you require.</span></span> <span data-ttu-id="c5688-195">Jei paliksite šį pasirinkties parametrą, .xslx failai bus importuojami iš sukonfigūruotų šaltinių (šiame pavyzdyje – „SharePoint“ aplankų).</span><span class="sxs-lookup"><span data-stu-id="c5688-195">If you keep the setting of this option, the .xslx files are imported from the configured sources (the SharePoint folders, in this example).</span></span>

    <span data-ttu-id="c5688-196">Šiame pavyzdyje importuojate tik vieną failą.</span><span class="sxs-lookup"><span data-stu-id="c5688-196">In this example, you're importing only one file.</span></span> <span data-ttu-id="c5688-197">Tačiau, jei yra keli failai, jie pasirinkti importuoti ta tvarka, kuria jie buvo įtraukti į „SharePoint“ aplanką.</span><span class="sxs-lookup"><span data-stu-id="c5688-197">However, if there are multiple files, they are selected for importing in the order in which they were added to the SharePoint folder.</span></span> <span data-ttu-id="c5688-198">Kaskart vykdant ER formatą, importuojamas vienas pasirinktas failas.</span><span class="sxs-lookup"><span data-stu-id="c5688-198">Every run of an ER format imports a single selected file.</span></span>

<span data-ttu-id="c5688-199">[![ER modelio susiejimo vykdymas](./media/GERImportFromSharePoint-11-RunModelMapping.PNG)](./media/GERImportFromSharePoint-11-RunModelMapping.PNG)</span><span class="sxs-lookup"><span data-stu-id="c5688-199">[![Run ER model mapping](./media/GERImportFromSharePoint-11-RunModelMapping.PNG)](./media/GERImportFromSharePoint-11-RunModelMapping.PNG)</span></span>

4. <span data-ttu-id="c5688-200">Modelio susiejimą galima vykdyti paketiniu režimu be priežiūros.</span><span class="sxs-lookup"><span data-stu-id="c5688-200">The model mapping can run unattended in batch mode.</span></span> <span data-ttu-id="c5688-201">Tokiu atveju, kiekvieną kartą, kai paketas vykdomas šiuo ER formatu, iš sukonfigūruotų failų šaltinių importuojamas vienas failas.</span><span class="sxs-lookup"><span data-stu-id="c5688-201">In this case, every time that a batch runs this ER format, a single file is imported from the configured file sources.</span></span> <span data-ttu-id="c5688-202">Naudokite šį kodą norėdami įdiegti šį paketo paleidimą.</span><span class="sxs-lookup"><span data-stu-id="c5688-202">Use the following code to implement this batch run.</span></span>

    ```
    ERObjectsFactory::createMappingDestinationRunByImportFormatMappingId().run()
    ```

    <span data-ttu-id="c5688-203">Kai failas sėkmingai importuotas iš „SharePoint“ aplanko, jis panaikinamas iš šio katalogo.</span><span class="sxs-lookup"><span data-stu-id="c5688-203">When a file is successfully imported from the SharePoint folder, it's deleted from that folder.</span></span>

5. <span data-ttu-id="c5688-204">Įveskite kvito ID, pvz., **V-00001**, tada pasirinkite **Gerai**.</span><span class="sxs-lookup"><span data-stu-id="c5688-204">Enter the voucher ID, such as **V-00001**, and then select **OK**.</span></span>

<span data-ttu-id="c5688-205">[![ER modelio susiejimo vykdymas](./media/GERImportFromSharePoint-12-ModelMappingRunFinished.PNG)](./media/GERImportFromSharePoint-12-ModelMappingRunFinished.PNG)</span><span class="sxs-lookup"><span data-stu-id="c5688-205">[![Run ER model mapping](./media/GERImportFromSharePoint-12-ModelMappingRunFinished.PNG)](./media/GERImportFromSharePoint-12-ModelMappingRunFinished.PNG)</span></span>

6. <span data-ttu-id="c5688-206">Puslapyje **Šaltinių failų būsenos** pasirinkę **Atnaujinti** atnaujinsite puslapį.</span><span class="sxs-lookup"><span data-stu-id="c5688-206">On the **File states for the sources** page, select **Refresh** to refresh the page.</span></span>

<span data-ttu-id="c5688-207">[![Pasirinktų šaltinių ER failų būsenų puslapis](./media/GERImportFromSharePoint-13-FileStatesForm.PNG)](./media/GERImportFromSharePoint-13-FileStatesForm.PNG)</span><span class="sxs-lookup"><span data-stu-id="c5688-207">[![ER file states page for the selected sources](./media/GERImportFromSharePoint-13-FileStatesForm.PNG)](./media/GERImportFromSharePoint-13-FileStatesForm.PNG)</span></span>

7. <span data-ttu-id="c5688-208">Skyriuje **Failai** peržiūrėkite failų sąrašą.</span><span class="sxs-lookup"><span data-stu-id="c5688-208">In the **Files** section, review the list of files.</span></span> <span data-ttu-id="c5688-209">Skyriuje **Importavimo formato šaltinių žurnalas** pateikiama „Excel“ failo importavimo retrospektyva.</span><span class="sxs-lookup"><span data-stu-id="c5688-209">The **Sources log for the import format** section provides the history of the Excel file import.</span></span> <span data-ttu-id="c5688-210">Kadangi šis failas buvo sėkmingai importuotas, „SharePoint“ aplanke jis pažymėtas kaip **Panaikintas**.</span><span class="sxs-lookup"><span data-stu-id="c5688-210">Because this file was successfully imported, it's marked as **Deleted** in the SharePoint folder.</span></span>
8. <span data-ttu-id="c5688-211">Peržiūrėkite „SharePoint“ aplanką **Failų importavimo šaltinis (pagrindinis)**.</span><span class="sxs-lookup"><span data-stu-id="c5688-211">Review the **Files import source (main)** SharePoint folder.</span></span> <span data-ttu-id="c5688-212">Tie „Excel“ failai, kurie buvo sėkmingai importuoti, yra panaikinti iš šio aplanko.</span><span class="sxs-lookup"><span data-stu-id="c5688-212">The Excel files that were successfully imported have been deleted from this folder.</span></span>
9. <span data-ttu-id="c5688-213">Sprendime „Finance and Operations“ pasirinkite **Mokėtinos sumos** \> **Periodinės užduotys** \> **Mokestis 1099** \> **1099 tiekėjo sudengimas**.</span><span class="sxs-lookup"><span data-stu-id="c5688-213">In Finance and Operations, select **Accounts payable** \> **Periodic tasks** \> **Tax 1099** \> **Vendor settlement for 1099s**.</span></span>
10. <span data-ttu-id="c5688-214">Laukuose **Pradžios data** ir **Pabaigos data** įveskite tinkamas vertes.</span><span class="sxs-lookup"><span data-stu-id="c5688-214">In the **From date** and **To date** fields, enter appropriate values.</span></span> <span data-ttu-id="c5688-215">Tada pasirinkite **Rankiniu būdu atliekamos 1099 operacijos**.</span><span class="sxs-lookup"><span data-stu-id="c5688-215">Then select **Manual 1099 transactions**.</span></span>

    <span data-ttu-id="c5688-216">Tiekėjo operacijos, kurios buvo importuotos iš „SharePoint“ platformoje esančių „Excel“ failų kvitui **V-00001**, yra pateikiamos puslapyje.</span><span class="sxs-lookup"><span data-stu-id="c5688-216">The vendor transactions that were imported from the Excel files on SharePoint for voucher **V-00001**, are presented on the page.</span></span>

<span data-ttu-id="c5688-217">[![1099 tiekėjo operacijų puslapis](./media/GERImportFromSharePoint-14-ImportedTransactions.PNG)](./media/GERImportFromSharePoint-14-ImportedTransactions.PNG)</span><span class="sxs-lookup"><span data-stu-id="c5688-217">[![1099 vendor transactions page](./media/GERImportFromSharePoint-14-ImportedTransactions.PNG)](./media/GERImportFromSharePoint-14-ImportedTransactions.PNG)</span></span>

## <a name="prepare-an-excel-file-for-import"></a><span data-ttu-id="c5688-218">„Excel“ failo paruošimas importuoti</span><span class="sxs-lookup"><span data-stu-id="c5688-218">Prepare an Excel file for import</span></span>
1. <span data-ttu-id="c5688-219">Atidarykite „Excel“ failą, kurį naudojote anksčiau.</span><span class="sxs-lookup"><span data-stu-id="c5688-219">Open the Excel file that you previously used.</span></span> <span data-ttu-id="c5688-220">Į 3 eilutės 1 stulpelį įtraukite tiekėjo kodą, kurio nėra programoje.</span><span class="sxs-lookup"><span data-stu-id="c5688-220">In row 3 column 1, add a vendor code that doesn't exist in the application.</span></span> <span data-ttu-id="c5688-221">Įtraukite papildomą klaidingą tiekėjo informaciją į eilutę.</span><span class="sxs-lookup"><span data-stu-id="c5688-221">Add additional false vendor information to the row.</span></span>

<span data-ttu-id="c5688-222">[![„Microsoft Excel“ failo, skirto importuoti iš „SharePoint“ pavyzdys](./media/GERImportFromSharePoint-15-Excel.PNG)](./media/GERImportFromSharePoint-15-Excel.PNG)</span><span class="sxs-lookup"><span data-stu-id="c5688-222">[![Sample Microsoft Excel file for importing from SharePoint](./media/GERImportFromSharePoint-15-Excel.PNG)](./media/GERImportFromSharePoint-15-Excel.PNG)</span></span>

2. <span data-ttu-id="c5688-223">Įkelti atnaujintą „Excel“ failą, kuriame yra tiekėjų operacijos, į „SharePoint“ aplanką **Failų importavimo šaltinis (pagrindinis)**.</span><span class="sxs-lookup"><span data-stu-id="c5688-223">Upload the updated Excel file that contains vendors transactions to the **Files import source (main)** SharePoint folder.</span></span>
3. <span data-ttu-id="c5688-224">Sprendime „Finance and Operations“ atidarykite ER konfigūracijos medį, pasirinkite **1099 mokėjimų modelis** ir išplėskite ER modelio komponentų sąrašą.</span><span class="sxs-lookup"><span data-stu-id="c5688-224">In Finance and Operations, open the ER configurations tree, select the **1099 Payment model**, and expand the list of ER model components.</span></span>
4. <span data-ttu-id="c5688-225">Pasirinkite modelio susiejimo pavadinimą norėdami atnaujinti modelio susiejimą taip, kad duomenų importavimo proceso metu neteisingas tiekėjo kodas būtų laikomas klaida.</span><span class="sxs-lookup"><span data-stu-id="c5688-225">Select the name of the model mapping to update the model mapping so that the incorrect vendor code is considered an error during the data import process.</span></span>
5. <span data-ttu-id="c5688-226">Pasirinkite **Dizaino įrankis**.</span><span class="sxs-lookup"><span data-stu-id="c5688-226">Select **Designer**.</span></span>
6. <span data-ttu-id="c5688-227">Skirtuke **Tikrinimai** turite pakeisti tolesnio tikrinimo veiksmą tos tikrinimo taisyklės, kuri buvo sukonfigūruota norint įvertinti, ar importuota tiekėjo sąskaita yra programoje.</span><span class="sxs-lookup"><span data-stu-id="c5688-227">On the **Validations** tab, you must change the post-validation action for the validation rule that was configured to evaluate whether the vendor account that is imported exists in the application.</span></span> <span data-ttu-id="c5688-228">Atnaujinkite lauko **Tolesnio tikrinimo veiksmas** vertę į **Sustabdyti vykdymą**, įrašykite pakeitimus ir uždarykite puslapį.</span><span class="sxs-lookup"><span data-stu-id="c5688-228">Update the value of the **Post-validation action** field to **Stop execution**, save your changes, and close the page.</span></span>

<span data-ttu-id="c5688-229">[![ER modelio susiejimo dizaino įrankio puslapis](./media/GERImportFromSharePoint-16-UpdateModelMapping.PNG)](./media/GERImportFromSharePoint-16-UpdateModelMapping.PNG)</span><span class="sxs-lookup"><span data-stu-id="c5688-229">[![ER model mapping designer page](./media/GERImportFromSharePoint-16-UpdateModelMapping.PNG)](./media/GERImportFromSharePoint-16-UpdateModelMapping.PNG)</span></span>

7. <span data-ttu-id="c5688-230">Įrašykite pakeitimus ir uždarykite ER modelio susiejimo dizaino įrankį.</span><span class="sxs-lookup"><span data-stu-id="c5688-230">Save your changes, and close the ER model mapping designer.</span></span>
8. <span data-ttu-id="c5688-231">Pasirinkę **Vykdyti** paleisite modifikuotą ER modelio susiejimą.</span><span class="sxs-lookup"><span data-stu-id="c5688-231">Select **Run** to run the modified ER model mapping.</span></span>
9. <span data-ttu-id="c5688-232">Įveskite kvito ID, pvz., **V-00002**, tada pasirinkite **Gerai**.</span><span class="sxs-lookup"><span data-stu-id="c5688-232">Enter the voucher ID, such as **V-00002**, and then select **OK**.</span></span>

    <span data-ttu-id="c5688-233">Atkreipkite dėmesį, kad informaciniame žurnale yra pranešimas, informuojantis, kad „SharePoint“ aplanko faile yra netinkama tiekėjo sąskaita ir importuoti negalima.</span><span class="sxs-lookup"><span data-stu-id="c5688-233">Note that the Infolog contains the notification informing that residing in SharePoint folder file contains incorrect vendor account and can’t be imported.</span></span>

<span data-ttu-id="c5688-234">[![ER modelio susiejimo vykdymas](./media/GERImportFromSharePoint-17-ModelMappingRunFinished.PNG)](./media/GERImportFromSharePoint-17-ModelMappingRunFinished.PNG)</span><span class="sxs-lookup"><span data-stu-id="c5688-234">[![Run ER model mapping](./media/GERImportFromSharePoint-17-ModelMappingRunFinished.PNG)](./media/GERImportFromSharePoint-17-ModelMappingRunFinished.PNG)</span></span>

10. <span data-ttu-id="c5688-235">Puslapyje **Šaltinių failų būsenos** pasirinkite **Atnaujinti**, tuomet skyriuje **Failai** peržiūrėkite failų sąrašą.</span><span class="sxs-lookup"><span data-stu-id="c5688-235">On the **File states for the sources** page, select **Refresh**, and then, in the **Files** section, review the list of files.</span></span>

<span data-ttu-id="c5688-236">[![Pasirinktų šaltinių ER failų būsenų puslapis](./media/GERImportFromSharePoint-18-FileStatesForm.PNG)](./media/GERImportFromSharePoint-18-FileStatesForm.PNG)</span><span class="sxs-lookup"><span data-stu-id="c5688-236">[![ER file states page for the selected sources](./media/GERImportFromSharePoint-18-FileStatesForm.PNG)](./media/GERImportFromSharePoint-18-FileStatesForm.PNG)</span></span>

<span data-ttu-id="c5688-237">Skyriuje **Importavimo formato šaltinių žurnalas** nurodyta, kad importavimo procesas nepavyko ir kad failas vis dar yra „SharePoint“ aplanke (žymės langelis **Panaikintas** nėra pažymėtas).</span><span class="sxs-lookup"><span data-stu-id="c5688-237">The **Sources log for the import format** section indicates that the import process failed and that the file is still in the SharePoint folder (the **Is deleted** checkbox is not selected).</span></span> <span data-ttu-id="c5688-238">Jei ištaisysite šį failą „SharePoint“ įtraukę tinkamą tiekėjo kodą, tada pakeisite failo būseną iš **Nepavyko** į **Parengta** skyriuje **Importavimo formato šaltinių žurnalas**, vėl galėsite importuoti failą.</span><span class="sxs-lookup"><span data-stu-id="c5688-238">If you fix this file on SharePoint by adding the proper vendor code and then change the status of the file from **Failed** to **Ready** in the **Sources log for the import format** section, you can import the file again.</span></span>

11. <span data-ttu-id="c5688-239">Peržiūrėkite „SharePoint“ aplanką **Failų importavimo šaltinis (pagrindinis)**.</span><span class="sxs-lookup"><span data-stu-id="c5688-239">Review the **Files import source (main)** SharePoint folder.</span></span> <span data-ttu-id="c5688-240">Atkreipkite dėmesį, kad „Excel“ failas, kuris nebuvo importuotas, vis dar yra šiame aplanke.</span><span class="sxs-lookup"><span data-stu-id="c5688-240">Notice that the Excel file that wasn't imported is still in this folder.</span></span>
12. <span data-ttu-id="c5688-241">Sprendime „Finance and Operations“ pasirinkite **Mokėtinos sumos** \> **Periodinės užduotys** \> **1099 mokestis** \> **1099 tiekėjo sudengimas**, laukuose **Pradžios data** ir **Pabaigos data** įveskite atitinkamas vertes, tada pasirinkite **Rankiniu būdu atliekamos 1099 operacijos**.</span><span class="sxs-lookup"><span data-stu-id="c5688-241">In Finance and Operations, select **Accounts payable** \> **Periodic tasks** \> **Tax 1099** \> **Vendor settlement for 1099s**, enter appropriate values in the **From date** and **To date** fields, and then select **Manual 1099 transactions**.</span></span>

    <span data-ttu-id="c5688-242">Galimos tik V-00001 kvito operacijos.</span><span class="sxs-lookup"><span data-stu-id="c5688-242">Only transactions for voucher V-00001 are available.</span></span> <span data-ttu-id="c5688-243">Jokios kvito V-00002 operacijos nėra galimos, nors paskutinės importuotos operacijos klaida rasta „Excel“ faile.</span><span class="sxs-lookup"><span data-stu-id="c5688-243">No transactions for voucher V-00002 are available even though the error for the last imported transaction has been found in the Excel file.</span></span>

